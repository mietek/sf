<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link href="common/css/sf.css" rel="stylesheet" type="text/css" />
<title>Perm: Basic Techniques for Comparisons and Permutations</title>
<link href="common/jquery-ui/jquery-ui.css" rel="stylesheet">
<script src="common/jquery-ui/external/jquery/jquery.js"></script>
<script src="common/jquery-ui/jquery-ui.js"></script>
<script src="common/toggleproofs.js"></script>
<link href="common/css/vfa.css" rel="stylesheet" type="text/css"/>
</head>

<body>

<div id="page">

<div id="header">
<div id='logoinheader'><a href='https://softwarefoundations.cis.upenn.edu'>
<img src='common/media/image/sf_logo_sm.png' alt='Software Foundations Logo'></a></div>
<div class='booktitleinheader'><a href='index.html'>Volume 3: Verified Functional Algorithms</a></div>
<ul id='menu'>
   <li class='section_name'><a href='toc.html'>Table of Contents</a></li>
   <li class='section_name'><a href='coqindex.html'>Index</a></li>
   <li class='section_name'><a href='deps.html'>Roadmap</a></li>
</ul>
</div>

<div id="main">

<h1 class="libtitle">Perm<span class="subtitle">Basic Techniques for Comparisons and Permutations</span></h1>

<div class="code">
</div>

<div class="doc">

<div class="paragraph"> </div>

 Consider these algorithms and data structures:
<ul class="doclist">
<li> sort a sequence of numbers

</li>
<li> finite maps from numbers to (arbitrary-type) data

</li>
<li> finite maps from any ordered type to (arbitrary-type) data

</li>
<li> priority queues: finding/deleting the highest number in a set

</li>
</ul>

<div class="paragraph"> </div>

    To prove the correctness of such programs, we need to reason about
    comparisons, and about whether two collections have the same
    contents.  In this chapter, we introduce some techniques for
    reasoning about:

<div class="paragraph"> </div>

<ul class="doclist">
<li> less-than comparisons on natural numbers, and

</li>
<li> permutations (rearrangements of lists).

</li>
</ul>

<div class="paragraph"> </div>

    In later chapters, we'll apply these proof techniques to reasoning
    about algorithms and data structures. 
</div>

<div class="doc">
<a id="lab11"></a><h1 class="section">The Less-Than Order on the Natural Numbers</h1>

<div class="paragraph"> </div>

 In our proofs about searching and sorting algorithms, we often
    have to reason about the less-than order on natural numbers.
    greater-than. Recall that the Coq standard library contains both
    propositional and Boolean less-than operators on natural numbers.
    We write <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode">&lt;</span> <span class="inlinecode"><span class="id" title="var">y</span></span> for the proposition that <span class="inlinecode"><span class="id" title="var">x</span></span> is less than <span class="inlinecode"><span class="id" title="var">y</span></span>: 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Locate</span> "_ &lt; _". <span class="comment">(*&nbsp;"x&nbsp;&lt;&nbsp;y"&nbsp;:=&nbsp;lt&nbsp;x&nbsp;y&nbsp;*)</span><br/>
<span class="id" title="keyword">Check</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Peano.html#lt"><span class="id" title="definition">lt</span></a> : <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>.<br/>
</div>

<div class="doc">
And we write <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode">&lt;?</span> <span class="inlinecode"><span class="id" title="var">y</span></span> for the computation that returns <span class="inlinecode"><span class="id" title="var">true</span></span> or
    <span class="inlinecode"><span class="id" title="var">false</span></span> depending on whether <span class="inlinecode"><span class="id" title="var">x</span></span> is less than <span class="inlinecode"><span class="id" title="var">y</span></span>: 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Locate</span> "_ &lt;? _". <span class="comment">(*&nbsp;x&nbsp;&lt;?&nbsp;y&nbsp;&nbsp;:=&nbsp;Nat.ltb&nbsp;x&nbsp;y&nbsp;*)</span><br/>
<span class="id" title="keyword">Check</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Arith.PeanoNat.html#Nat.ltb"><span class="id" title="definition">Nat.ltb</span></a> : <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a>.<br/>
</div>

<div class="doc">
Operation <span class="inlinecode">&lt;</span> is a reflection of <span class="inlinecode">&lt;?</span>, as discussed in
    <a href="https://softwarefoundations.cis.upenn.edu/lf-current/Logic.html"><span class="inlineref">Logic</span></a> and <a href="https://softwarefoundations.cis.upenn.edu/lf-current/IndProp.html"><span class="inlineref">IndProp</span></a>. The <span class="inlinecode"><span class="id" title="var">Nat</span></span> module has a
    theorem showing how they relate: 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Check</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Arith.PeanoNat.html#Nat.ltb_lt"><span class="id" title="lemma">Nat.ltb_lt</span></a> : <span class="id" title="keyword">∀</span> <a id="n:1" class="idref" href="#n:1"><span class="id" title="binder">n</span></a> <a id="m:2" class="idref" href="#m:2"><span class="id" title="binder">m</span></a> : <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>, <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><a class="idref" href="Perm.html#n:1"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Arith.PeanoNat.html#6b7621b45fff0af5e2b2cbb2bc2d4e1d"><span class="id" title="notation">&lt;?</span></a> <a class="idref" href="Perm.html#m:2"><span class="id" title="variable">m</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">↔</span></a> <a class="idref" href="Perm.html#n:1"><span class="id" title="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Peano.html#::nat_scope:x_'&lt;'_x"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="Perm.html#m:2"><span class="id" title="variable">m</span></a>.<br/>
</div>

<div class="doc">
The <span class="inlinecode"><span class="id" title="var">Nat</span></span> module contains a synonym for <span class="inlinecode"><span class="id" title="var">lt</span></span>. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Print</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Arith.PeanoNat.html#Nat.lt"><span class="id" title="definition">Nat.lt</span></a>. <span class="comment">(*&nbsp;Nat.lt&nbsp;=&nbsp;lt&nbsp;*)</span><br/>
</div>

<div class="doc">
For unknown reasons, <span class="inlinecode"><span class="id" title="var">Nat</span></span> does not define notations
    for <span class="inlinecode">&gt;?</span> or <span class="inlinecode">&gt;=?</span>.  So we define them here: 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Notation</span>  <a id="911767defbca4d8b1a0af5b4111529f<sub>1</sub>" class="idref" href="#911767defbca4d8b1a0af5b4111529f<sub>1</sub>"><span class="id" title="notation">&quot;</span></a>a &gt;=? b" := (<a class="idref" href="http://coq.inria.fr/library//Coq.Arith.PeanoNat.html#Nat.leb"><span class="id" title="definition">Nat.leb</span></a> <span class="id" title="var">b</span> <span class="id" title="var">a</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 70) : <span class="id" title="var">nat_scope</span>.<br/>
<span class="id" title="keyword">Notation</span>  <a id="5ea9023a94e85f78711b2bf8cc72c8f<sub>4</sub>" class="idref" href="#5ea9023a94e85f78711b2bf8cc72c8f<sub>4</sub>"><span class="id" title="notation">&quot;</span></a>a &gt;? b"  := (<a class="idref" href="http://coq.inria.fr/library//Coq.Arith.PeanoNat.html#Nat.ltb"><span class="id" title="definition">Nat.ltb</span></a> <span class="id" title="var">b</span> <span class="id" title="var">a</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 70) : <span class="id" title="var">nat_scope</span>.<br/>
</div>

<div class="doc">
<a id="lab12"></a><h2 class="section">The Omega Tactic</h2>

<div class="paragraph"> </div>

 Reasoning about inequalities by hand can be a little painful. Luckily, Coq
    provides a tactic called <span class="inlinecode"><span class="id" title="tactic">omega</span></span> that is quite helpful. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a id="omega_example1" class="idref" href="#omega_example1"><span class="id" title="lemma">omega_example1</span></a>:<br/>
&nbsp;<span class="id" title="keyword">∀</span> <a id="i:3" class="idref" href="#i:3"><span class="id" title="binder">i</span></a> <a id="j:4" class="idref" href="#j:4"><span class="id" title="binder">j</span></a> <a id="k:5" class="idref" href="#k:5"><span class="id" title="binder">k</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Perm.html#i:3"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Peano.html#::nat_scope:x_'&lt;'_x"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="Perm.html#j:4"><span class="id" title="variable">j</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">¬</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">(</span></a><a class="idref" href="Perm.html#k:5"><span class="id" title="variable">k</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Peano.html#::nat_scope:x_'-'_x"><span class="id" title="notation">-</span></a> 3 <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a<sub>3</sub>"><span class="id" title="notation">≤</span></a> <a class="idref" href="Perm.html#j:4"><span class="id" title="variable">j</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;<a class="idref" href="Perm.html#k:5"><span class="id" title="variable">k</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Peano.html#::nat_scope:x_'&gt;'_x"><span class="id" title="notation">&gt;</span></a> <a class="idref" href="Perm.html#i:3"><span class="id" title="variable">i</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
</div>

<div class="doc">
The hard way to prove this is by hand. 
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;try&nbsp;to&nbsp;remember&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;lemma&nbsp;about&nbsp;negation&nbsp;and&nbsp;<span class="inlinecode">≤</span>&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Search</span> (<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">¬</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a<sub>3</sub>"><span class="id" title="notation">≤</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Arith.Compare_dec.html#not_le"><span class="id" title="lemma">not_le</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H<sub>0</sub></span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;try&nbsp;to&nbsp;remember&nbsp;the&nbsp;name&nbsp;of&nbsp;the&nbsp;transitivity&nbsp;lemma&nbsp;about&nbsp;<span class="inlinecode">&gt;</span>&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Search</span> (<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Peano.html#::nat_scope:x_'&gt;'_x"><span class="id" title="notation">&gt;</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Peano.html#::nat_scope:x_'&gt;'_x"><span class="id" title="notation">&gt;</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Peano.html#::nat_scope:x_'&gt;'_x"><span class="id" title="notation">&gt;</span></a> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Arith.Gt.html#gt_trans"><span class="id" title="lemma">gt_trans</span></a> <span class="id" title="keyword">with</span> <span class="id" title="var">j</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Arith.Gt.html#gt_trans"><span class="id" title="lemma">gt_trans</span></a> <span class="id" title="keyword">with</span> (<span class="id" title="var">k</span><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Peano.html#::nat_scope:x_'-'_x"><span class="id" title="notation">-</span></a>3).<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Is&nbsp;<span class="inlinecode"><span class="id" title="var">k</span></span>&nbsp;greater&nbsp;than&nbsp;<span class="inlinecode"><span class="id" title="var">k</span>-3</span>?&nbsp;On&nbsp;the&nbsp;integers,&nbsp;sure.&nbsp;But&nbsp;we're&nbsp;working<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;with&nbsp;natural&nbsp;numbers,&nbsp;which&nbsp;truncate&nbsp;subtraction&nbsp;at&nbsp;zero.&nbsp;*)</span><br/>
<span class="id" title="keyword">Abort</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Theorem</span> <a id="truncated_subtraction" class="idref" href="#truncated_subtraction"><span class="id" title="lemma">truncated_subtraction</span></a>: <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">¬</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">(</span></a><span class="id" title="keyword">∀</span> <a id="k:6" class="idref" href="#k:6"><span class="id" title="binder">k</span></a>:<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>, <a class="idref" href="Perm.html#k:6"><span class="id" title="variable">k</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Peano.html#::nat_scope:x_'&gt;'_x"><span class="id" title="notation">&gt;</span></a> <a class="idref" href="Perm.html#k:6"><span class="id" title="variable">k</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Peano.html#::nat_scope:x_'-'_x"><span class="id" title="notation">-</span></a> 3<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">contra</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;<span class="inlinecode"><span class="id" title="tactic">specialize</span></span>&nbsp;applies&nbsp;a&nbsp;hypothesis&nbsp;to&nbsp;an&nbsp;argument&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">contra</span> 0).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">contra</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">contra</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
Since subtraction is truncated, does <span class="inlinecode"><span class="id" title="var">omega_example1</span></span> actually hold?
    It does. Let's try again, the hard way, to find the proof. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a id="omega_example1" class="idref" href="#omega_example1"><span class="id" title="lemma">omega_example1</span></a>:<br/>
&nbsp;<span class="id" title="keyword">∀</span> <a id="i:7" class="idref" href="#i:7"><span class="id" title="binder">i</span></a> <a id="j:8" class="idref" href="#j:8"><span class="id" title="binder">j</span></a> <a id="k:9" class="idref" href="#k:9"><span class="id" title="binder">k</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Perm.html#i:7"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Peano.html#::nat_scope:x_'&lt;'_x"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="Perm.html#j:8"><span class="id" title="variable">j</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">¬</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">(</span></a><a class="idref" href="Perm.html#k:9"><span class="id" title="variable">k</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Peano.html#::nat_scope:x_'-'_x"><span class="id" title="notation">-</span></a> 3 <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a<sub>3</sub>"><span class="id" title="notation">≤</span></a> <a class="idref" href="Perm.html#j:8"><span class="id" title="variable">j</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;<a class="idref" href="Perm.html#k:9"><span class="id" title="variable">k</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Peano.html#::nat_scope:x_'&gt;'_x"><span class="id" title="notation">&gt;</span></a> <a class="idref" href="Perm.html#i:7"><span class="id" title="variable">i</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="comment">(*&nbsp;try&nbsp;again!&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Arith.Compare_dec.html#not_le"><span class="id" title="lemma">not_le</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H<sub>0</sub></span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Peano.html#gt"><span class="id" title="definition">gt</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H<sub>0</sub></span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Peano.html#gt"><span class="id" title="definition">gt</span></a>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;try&nbsp;to&nbsp;remember&nbsp;the&nbsp;name&nbsp;...&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Search</span> (<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Peano.html#::nat_scope:x_'&lt;'_x"><span class="id" title="notation">&lt;</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a<sub>3</sub>"><span class="id" title="notation">≤</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Peano.html#::nat_scope:x_'&lt;'_x"><span class="id" title="notation">&lt;</span></a> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Arith.Lt.html#lt_le_trans"><span class="id" title="abbreviation">lt_le_trans</span></a> <span class="id" title="keyword">with</span> <span class="id" title="var">j</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Arith.Le.html#le_trans"><span class="id" title="abbreviation">le_trans</span></a> <span class="id" title="keyword">with</span> (<span class="id" title="var">k</span><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Peano.html#::nat_scope:x_'-'_x"><span class="id" title="notation">-</span></a>3).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Search</span> (<span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Peano.html#::nat_scope:x_'&lt;'_x"><span class="id" title="notation">&lt;</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a<sub>3</sub>"><span class="id" title="notation">≤</span></a> <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Arith.Lt.html#lt_le_weak"><span class="id" title="abbreviation">lt_le_weak</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Arith.Minus.html#le_minus"><span class="id" title="abbreviation">le_minus</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
That was tedious.  Here's a much easier way: 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a id="omega_example2" class="idref" href="#omega_example2"><span class="id" title="lemma">omega_example2</span></a>:<br/>
&nbsp;<span class="id" title="keyword">∀</span> <a id="i:10" class="idref" href="#i:10"><span class="id" title="binder">i</span></a> <a id="j:11" class="idref" href="#j:11"><span class="id" title="binder">j</span></a> <a id="k:12" class="idref" href="#k:12"><span class="id" title="binder">k</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Perm.html#i:10"><span class="id" title="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Peano.html#::nat_scope:x_'&lt;'_x"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="Perm.html#j:11"><span class="id" title="variable">j</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">¬</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">(</span></a><a class="idref" href="Perm.html#k:12"><span class="id" title="variable">k</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Peano.html#::nat_scope:x_'-'_x"><span class="id" title="notation">-</span></a> 3 <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a<sub>3</sub>"><span class="id" title="notation">≤</span></a> <a class="idref" href="Perm.html#j:11"><span class="id" title="variable">j</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;<a class="idref" href="Perm.html#k:12"><span class="id" title="variable">k</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Peano.html#::nat_scope:x_'&gt;'_x"><span class="id" title="notation">&gt;</span></a> <a class="idref" href="Perm.html#i:10"><span class="id" title="variable">i</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">omega</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
Omega is a decision procedure invented in 1991 by William Pugh for
    integer linear programming (ILP). The <span class="inlinecode"><span class="id" title="tactic">omega</span></span> tactic was made
    available by importing <span class="inlinecode"><span class="id" title="var">Coq.omega.Omega</span></span>, at the beginning of the
    file.  It is an implementation of Pugh's algorithm.  The tactic
    works with Coq types <span class="inlinecode"><span class="id" title="var">Z</span></span> and <span class="inlinecode"><span class="id" title="var">nat</span></span>, and these operators: <span class="inlinecode">&lt;</span> <span class="inlinecode">=</span> <span class="inlinecode">&gt;</span>
    <span class="inlinecode">≤</span> <span class="inlinecode">≥</span> <span class="inlinecode">+</span> <span class="inlinecode">-</span> <span class="inlinecode">¬</span>, as well as multiplication by small integer
    literals (such as 0,1,2,3...), and some uses of <span class="inlinecode">∨</span> and <span class="inlinecode">∧</span>.

<div class="paragraph"> </div>

    Omega does not "understand" other operators.  It treats
    expressions such as <span class="inlinecode"><span class="id" title="var">a</span></span> <span class="inlinecode">×</span> <span class="inlinecode"><span class="id" title="var">b</span></span> and <span class="inlinecode"><span class="id" title="var">f</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode"><span class="id" title="var">y</span></span> as variables.  That is, it
    can prove <span class="inlinecode"><span class="id" title="var">f</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode"><span class="id" title="var">y</span></span> <span class="inlinecode">&gt;</span> <span class="inlinecode"><span class="id" title="var">a</span></span> <span class="inlinecode">×</span> <span class="inlinecode"><span class="id" title="var">b</span></span> <span class="inlinecode">→</span> <span class="inlinecode"><span class="id" title="var">f</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode"><span class="id" title="var">y</span></span> <span class="inlinecode">+</span> <span class="inlinecode">3</span> <span class="inlinecode">≥</span> <span class="inlinecode"><span class="id" title="var">a</span></span> <span class="inlinecode">×</span> <span class="inlinecode"><span class="id" title="var">b</span></span>, in the same way it
    would prove <span class="inlinecode"><span class="id" title="var">u</span></span> <span class="inlinecode">&gt;</span> <span class="inlinecode"><span class="id" title="var">v</span></span> <span class="inlinecode">→</span> <span class="inlinecode"><span class="id" title="var">u</span></span> <span class="inlinecode">+</span> <span class="inlinecode">3</span> <span class="inlinecode">≥</span> <span class="inlinecode"><span class="id" title="var">v</span></span>. But it cannot reason about, e.g.,
    multiplication. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a id="omega_example_3" class="idref" href="#omega_example_3"><span class="id" title="lemma">omega_example_3</span></a> : <span class="id" title="keyword">∀</span> (<a id="f:13" class="idref" href="#f:13"><span class="id" title="binder">f</span></a> : <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) <a id="a:14" class="idref" href="#a:14"><span class="id" title="binder">a</span></a> <a id="b:15" class="idref" href="#b:15"><span class="id" title="binder">b</span></a> <a id="x:16" class="idref" href="#x:16"><span class="id" title="binder">x</span></a> <a id="y:17" class="idref" href="#y:17"><span class="id" title="binder">y</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Perm.html#f:13"><span class="id" title="variable">f</span></a> <a class="idref" href="Perm.html#x:16"><span class="id" title="variable">x</span></a> <a class="idref" href="Perm.html#y:17"><span class="id" title="variable">y</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Peano.html#::nat_scope:x_'&gt;'_x"><span class="id" title="notation">&gt;</span></a> <a class="idref" href="Perm.html#a:14"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Peano.html#ea2ff3d561159081cea6fb2e8113cc<sub>54</sub>"><span class="id" title="notation">×</span></a> <a class="idref" href="Perm.html#b:15"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="Perm.html#f:13"><span class="id" title="variable">f</span></a> <a class="idref" href="Perm.html#x:16"><span class="id" title="variable">x</span></a> <a class="idref" href="Perm.html#y:17"><span class="id" title="variable">y</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> 3 <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Peano.html#73030c22bc0b1fa771c65aa5414c65f<sub>9</sub>"><span class="id" title="notation">≥</span></a> <a class="idref" href="Perm.html#a:14"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Peano.html#ea2ff3d561159081cea6fb2e8113cc<sub>54</sub>"><span class="id" title="notation">×</span></a> <a class="idref" href="Perm.html#b:15"><span class="id" title="variable">b</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">omega</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Theorem</span> <a id="omega_example_4" class="idref" href="#omega_example_4"><span class="id" title="lemma">omega_example_4</span></a> : <span class="id" title="keyword">∀</span> <a id="a:18" class="idref" href="#a:18"><span class="id" title="binder">a</span></a> <a id="b:19" class="idref" href="#b:19"><span class="id" title="binder">b</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Perm.html#a:18"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Peano.html#ea2ff3d561159081cea6fb2e8113cc<sub>54</sub>"><span class="id" title="notation">×</span></a> <a class="idref" href="Perm.html#b:19"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Perm.html#b:19"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Peano.html#ea2ff3d561159081cea6fb2e8113cc<sub>54</sub>"><span class="id" title="notation">×</span></a> <a class="idref" href="Perm.html#a:18"><span class="id" title="variable">a</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">omega</span>.<br/>
<span class="id" title="keyword">Abort</span>.<br/>
</div>

<div class="doc">
The Omega algorithm is NP-complete, so we might expect that
    this tactic is exponential-time in the worst case.  Indeed,
    if you have <span class="inlinecode"><span class="id" title="var">N</span></span> equations, it could take <span class="inlinecode">2^<span class="id" title="var">N</span></span> time.
    But in the typical cases that result from reasoning about
    programs, <span class="inlinecode"><span class="id" title="tactic">omega</span></span> is much faster than that. 
</div>

<div class="doc">
<a id="lab13"></a><h1 class="section">Swapping</h1>

<div class="paragraph"> </div>

 Consider trying to sort a list of natural numbers.  As a small piece of
    a sorting algorithm, we might need to swap the first two elements of a list
    if they are out of order. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a id="maybe_swap" class="idref" href="#maybe_swap"><span class="id" title="definition">maybe_swap</span></a> (<a id="al:20" class="idref" href="#al:20"><span class="id" title="binder">al</span></a>: <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) : <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Perm.html#al:20"><span class="id" title="variable">al</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <span class="id" title="var">b</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <span class="id" title="var">ar</span> ⇒ <span class="id" title="keyword">if</span> <span class="id" title="var">a</span> <a class="idref" href="Perm.html#5ea9023a94e85f78711b2bf8cc72c8f<sub>4</sub>"><span class="id" title="notation">&gt;?</span></a> <span class="id" title="var">b</span> <span class="id" title="keyword">then</span> <span class="id" title="var">b</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <span class="id" title="var">ar</span> <span class="id" title="keyword">else</span> <span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <span class="id" title="var">b</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <span class="id" title="var">ar</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> ⇒ <a class="idref" href="Perm.html#al:20"><span class="id" title="variable">al</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Example</span> <a id="maybe_swap_123" class="idref" href="#maybe_swap_123"><span class="id" title="definition">maybe_swap_123</span></a>:<br/>
&nbsp;&nbsp;<a class="idref" href="Perm.html#maybe_swap"><span class="id" title="definition">maybe_swap</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">[</span></a>1<a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a> 2<a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a> 3<a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">]</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">[</span></a>1<a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a> 2<a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a> 3<a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">]</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Example</span> <a id="maybe_swap_321" class="idref" href="#maybe_swap_321"><span class="id" title="definition">maybe_swap_321</span></a>:<br/>
&nbsp;&nbsp;<a class="idref" href="Perm.html#maybe_swap"><span class="id" title="definition">maybe_swap</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">[</span></a>3<a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a> 2<a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a> 1<a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">]</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">[</span></a>2<a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a> 3<a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a> 1<a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">]</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">reflexivity</span>. <span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
Applying <span class="inlinecode"><span class="id" title="var">maybe_swap</span></span> twice should give the same result as applying it once.
    That is, <span class="inlinecode"><span class="id" title="var">maybe_swap</span></span> is <i>idempotent</i>. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a id="maybe_swap_idempotent" class="idref" href="#maybe_swap_idempotent"><span class="id" title="lemma">maybe_swap_idempotent</span></a>: <span class="id" title="keyword">∀</span> <a id="al:22" class="idref" href="#al:22"><span class="id" title="binder">al</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Perm.html#maybe_swap"><span class="id" title="definition">maybe_swap</span></a> (<a class="idref" href="Perm.html#maybe_swap"><span class="id" title="definition">maybe_swap</span></a> <a class="idref" href="Perm.html#al:22"><span class="id" title="variable">al</span></a>) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Perm.html#maybe_swap"><span class="id" title="definition">maybe_swap</span></a> <a class="idref" href="Perm.html#al:22"><span class="id" title="variable">al</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [ | <span class="id" title="var">a</span> [ | <span class="id" title="var">b</span> <span class="id" title="var">al</span>]]; <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">b</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Arith.PeanoNat.html#6b7621b45fff0af5e2b2cbb2bc2d4e1d"><span class="id" title="notation">&lt;?</span></a> <span class="id" title="var">a</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">Hb_lt_a</span>; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> (<span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Arith.PeanoNat.html#6b7621b45fff0af5e2b2cbb2bc2d4e1d"><span class="id" title="notation">&lt;?</span></a> <span class="id" title="var">b</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">Ha_lt_b</span>; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ </div>

<div class="doc">
Now what?  We have a contradiction in the hypotheses: it
          cannot hold that <span class="inlinecode"><span class="id" title="var">a</span></span> is less than <span class="inlinecode"><span class="id" title="var">b</span></span> and <span class="inlinecode"><span class="id" title="var">b</span></span> is less than
          <span class="inlinecode"><span class="id" title="var">a</span></span>.  Unfortunately, <span class="inlinecode"><span class="id" title="tactic">omega</span></span> cannot immediately show that
          for us, because it reasons about comparisons in <span class="inlinecode"><span class="id" title="keyword">Prop</span></span> not
          <span class="inlinecode"><span class="id" title="var">bool</span></span>. 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Fail</span> <span class="id" title="tactic">omega</span>.<br/>
<span class="id" title="keyword">Abort</span>.<br/>
</div>

<div class="doc">
Of course we could finish the proof by reasoning directly about
    inequalities in <span class="inlinecode"><span class="id" title="var">bool</span></span>.  But this situation is going to occur
    repeatedly in our study of sorting. 
<div class="paragraph"> </div>

 Let's set up some machinery to enable using <span class="inlinecode"><span class="id" title="tactic">omega</span></span> on boolean
    tests. 
<div class="paragraph"> </div>

<a id="lab14"></a><h2 class="section">Reflection</h2>

<div class="paragraph"> </div>

 The <span class="inlinecode"><span class="id" title="var">reflect</span></span> type, defined in the standard library (and presented
    in <a href="https://softwarefoundations.cis.upenn.edu/lf-current/IndProp.html"><span class="inlineref">IndProp</span></a>), relates a proposition to a Boolean. That is,
    a value of type <span class="inlinecode"><span class="id" title="var">reflect</span></span> <span class="inlinecode"><span class="id" title="var">P</span></span> <span class="inlinecode"><span class="id" title="var">b</span></span> contains a proof of <span class="inlinecode"><span class="id" title="var">P</span></span> if <span class="inlinecode"><span class="id" title="var">b</span></span> is
    <span class="inlinecode"><span class="id" title="var">true</span></span>, or a proof of <span class="inlinecode">¬</span> <span class="inlinecode"><span class="id" title="var">P</span></span> if <span class="inlinecode"><span class="id" title="var">b</span></span> is <span class="inlinecode"><span class="id" title="var">false</span></span>. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Print</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Bool.Bool.html#reflect"><span class="id" title="inductive">reflect</span></a>.<br/>
<span class="comment">(*<br/>
Inductive&nbsp;reflect&nbsp;(P&nbsp;:&nbsp;Prop)&nbsp;:&nbsp;bool&nbsp;<span class="nowrap"><span style='font-size:85%;'><span style='vertical-align:5%;'><span style='letter-spacing:-.2em;'>-</span></span>&gt;</span></span>&nbsp;Set&nbsp;:=<br/>
&nbsp;&nbsp;|&nbsp;ReflectT&nbsp;:&nbsp;&nbsp;&nbsp;P&nbsp;<span class="nowrap"><span style='font-size:85%;'><span style='vertical-align:5%;'><span style='letter-spacing:-.2em;'>-</span></span>&gt;</span></span>&nbsp;reflect&nbsp;P&nbsp;true<br/>
&nbsp;&nbsp;|&nbsp;ReflectF&nbsp;:&nbsp;~&nbsp;P&nbsp;<span class="nowrap"><span style='font-size:85%;'><span style='vertical-align:5%;'><span style='letter-spacing:-.2em;'>-</span></span>&gt;</span></span>&nbsp;reflect&nbsp;P&nbsp;false<br/>
&nbsp;*)</span><br/>
</div>

<div class="doc">
The standard library proves a theorem that says if <span class="inlinecode"><span class="id" title="var">P</span></span> is provable
    whenever <span class="inlinecode"><span class="id" title="var">b</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">true</span></span> is provable, then <span class="inlinecode"><span class="id" title="var">P</span></span> reflects <span class="inlinecode"><span class="id" title="var">b</span></span>. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Check</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Bool.Bool.html#iff_reflect"><span class="id" title="lemma">iff_reflect</span></a> : <span class="id" title="keyword">∀</span> (<a id="P:23" class="idref" href="#P:23"><span class="id" title="binder">P</span></a> : <span class="id" title="keyword">Prop</span>) (<a id="b:24" class="idref" href="#b:24"><span class="id" title="binder">b</span></a> : <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Perm.html#P:23"><span class="id" title="variable">P</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'&lt;-&gt;'_x"><span class="id" title="notation">↔</span></a> <a class="idref" href="Perm.html#b:24"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Bool.Bool.html#reflect"><span class="id" title="inductive">reflect</span></a> <a class="idref" href="Perm.html#P:23"><span class="id" title="variable">P</span></a> <a class="idref" href="Perm.html#b:24"><span class="id" title="variable">b</span></a>.<br/>
</div>

<div class="doc">
Using that theorem, we can quickly prove that the propositional
    (in)equality operators are reflections of the Boolean
    operators. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <a id="eqb_reflect" class="idref" href="#eqb_reflect"><span class="id" title="lemma">eqb_reflect</span></a> : <span class="id" title="keyword">∀</span> <a id="x:25" class="idref" href="#x:25"><span class="id" title="binder">x</span></a> <a id="y:26" class="idref" href="#y:26"><span class="id" title="binder">y</span></a>, <a class="idref" href="http://coq.inria.fr/library//Coq.Bool.Bool.html#reflect"><span class="id" title="inductive">reflect</span></a> (<a class="idref" href="Perm.html#x:25"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Perm.html#y:26"><span class="id" title="variable">y</span></a>) (<a class="idref" href="Perm.html#x:25"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Arith.PeanoNat.html#ad2ec4e405f68c46c0a176e3e94ae2e<sub>3</sub>"><span class="id" title="notation">=?</span></a> <a class="idref" href="Perm.html#y:26"><span class="id" title="variable">y</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Bool.Bool.html#iff_reflect"><span class="id" title="lemma">iff_reflect</span></a>. <span class="id" title="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Arith.PeanoNat.html#Nat.eqb_eq"><span class="id" title="lemma">Nat.eqb_eq</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="ltb_reflect" class="idref" href="#ltb_reflect"><span class="id" title="lemma">ltb_reflect</span></a> : <span class="id" title="keyword">∀</span> <a id="x:27" class="idref" href="#x:27"><span class="id" title="binder">x</span></a> <a id="y:28" class="idref" href="#y:28"><span class="id" title="binder">y</span></a>, <a class="idref" href="http://coq.inria.fr/library//Coq.Bool.Bool.html#reflect"><span class="id" title="inductive">reflect</span></a> (<a class="idref" href="Perm.html#x:27"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Peano.html#::nat_scope:x_'&lt;'_x"><span class="id" title="notation">&lt;</span></a> <a class="idref" href="Perm.html#y:28"><span class="id" title="variable">y</span></a>) (<a class="idref" href="Perm.html#x:27"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Arith.PeanoNat.html#6b7621b45fff0af5e2b2cbb2bc2d4e1d"><span class="id" title="notation">&lt;?</span></a> <a class="idref" href="Perm.html#y:28"><span class="id" title="variable">y</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Bool.Bool.html#iff_reflect"><span class="id" title="lemma">iff_reflect</span></a>. <span class="id" title="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Arith.PeanoNat.html#Nat.ltb_lt"><span class="id" title="lemma">Nat.ltb_lt</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Lemma</span> <a id="leb_reflect" class="idref" href="#leb_reflect"><span class="id" title="lemma">leb_reflect</span></a> : <span class="id" title="keyword">∀</span> <a id="x:29" class="idref" href="#x:29"><span class="id" title="binder">x</span></a> <a id="y:30" class="idref" href="#y:30"><span class="id" title="binder">y</span></a>, <a class="idref" href="http://coq.inria.fr/library//Coq.Bool.Bool.html#reflect"><span class="id" title="inductive">reflect</span></a> (<a class="idref" href="Perm.html#x:29"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a<sub>3</sub>"><span class="id" title="notation">≤</span></a> <a class="idref" href="Perm.html#y:30"><span class="id" title="variable">y</span></a>) (<a class="idref" href="Perm.html#x:29"><span class="id" title="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Arith.PeanoNat.html#0f31f5c1c6b6a21a3a187247222bc9e<sub>4</sub>"><span class="id" title="notation">&lt;=?</span></a> <a class="idref" href="Perm.html#y:30"><span class="id" title="variable">y</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Bool.Bool.html#iff_reflect"><span class="id" title="lemma">iff_reflect</span></a>. <span class="id" title="tactic">symmetry</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Arith.PeanoNat.html#Nat.leb_le"><span class="id" title="lemma">Nat.leb_le</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
Here's an example of how you could use these lemmas.  Suppose you
    have this simple program, <span class="inlinecode">(<span class="id" title="keyword">if</span></span> <span class="inlinecode"><span class="id" title="var">a</span></span> <span class="inlinecode">&lt;?</span> <span class="inlinecode">5</span> <span class="inlinecode"><span class="id" title="keyword">then</span></span> <span class="inlinecode"><span class="id" title="var">a</span></span> <span class="inlinecode"><span class="id" title="keyword">else</span></span> <span class="inlinecode">2)</span>, and you
    want to prove that it evaluates to a number smaller than 6.  You
    can use <span class="inlinecode"><span class="id" title="var">ltb_reflect</span></span> "by hand": 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Example</span> <a id="reflect_example1" class="idref" href="#reflect_example1"><span class="id" title="definition">reflect_example1</span></a>: <span class="id" title="keyword">∀</span> <a id="a:31" class="idref" href="#a:31"><span class="id" title="binder">a</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Peano.html#::nat_scope:x_'&lt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">if</span> <a class="idref" href="Perm.html#a:31"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Arith.PeanoNat.html#6b7621b45fff0af5e2b2cbb2bc2d4e1d"><span class="id" title="notation">&lt;?</span></a> 5 <span class="id" title="keyword">then</span> <a class="idref" href="Perm.html#a:31"><span class="id" title="variable">a</span></a> <span class="id" title="keyword">else</span> 2<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Peano.html#::nat_scope:x_'&lt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Peano.html#::nat_scope:x_'&lt;'_x"><span class="id" title="notation">&lt;</span></a> 6.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;The&nbsp;next&nbsp;two&nbsp;lines&nbsp;aren't&nbsp;strictly&nbsp;necessary,&nbsp;but&nbsp;they<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;help&nbsp;make&nbsp;it&nbsp;clear&nbsp;what&nbsp;<span class="inlinecode"><span class="id" title="tactic">destruct</span></span>&nbsp;does.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">R</span>: <a class="idref" href="http://coq.inria.fr/library//Coq.Bool.Bool.html#reflect"><span class="id" title="inductive">reflect</span></a> (<span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Peano.html#::nat_scope:x_'&lt;'_x"><span class="id" title="notation">&lt;</span></a> 5) (<span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Arith.PeanoNat.html#6b7621b45fff0af5e2b2cbb2bc2d4e1d"><span class="id" title="notation">&lt;?</span></a> 5)) <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="Perm.html#ltb_reflect"><span class="id" title="lemma">ltb_reflect</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">remember</span> (<span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Arith.PeanoNat.html#6b7621b45fff0af5e2b2cbb2bc2d4e1d"><span class="id" title="notation">&lt;?</span></a> 5) <span class="id" title="keyword">as</span> <span class="id" title="var">guard</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">R</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">H</span>|<span class="id" title="var">H</span>] <span class="id" title="var">eqn</span>:<span class="id" title="var">HR</span>.<br/>
&nbsp;&nbsp;× <span class="comment">(*&nbsp;ReflectT&nbsp;*)</span> <span class="id" title="tactic">omega</span>.<br/>
&nbsp;&nbsp;× <span class="comment">(*&nbsp;ReflectF&nbsp;*)</span> <span class="id" title="tactic">omega</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
For the <span class="inlinecode"><span class="id" title="var">ReflectT</span></span> constructor, the guard <span class="inlinecode"><span class="id" title="var">a</span></span> <span class="inlinecode">&lt;?</span> <span class="inlinecode">5</span> must be equal
    to <span class="inlinecode"><span class="id" title="var">true</span></span>. The <span class="inlinecode"><span class="id" title="keyword">if</span></span> expression in the goal has already been
    simplified to take advantage of that fact. Also, for <span class="inlinecode"><span class="id" title="var">ReflectT</span></span> to
    have been used, there must be evidence <span class="inlinecode"><span class="id" title="var">H</span></span> that <span class="inlinecode"><span class="id" title="var">a</span></span> <span class="inlinecode">&lt;</span> <span class="inlinecode">5</span> holds.
    From there, all that remains is to show <span class="inlinecode"><span class="id" title="var">a</span></span> <span class="inlinecode">&lt;</span> <span class="inlinecode">5</span> entails <span class="inlinecode"><span class="id" title="var">a</span></span> <span class="inlinecode">&lt;</span> <span class="inlinecode">6</span>.
    The <span class="inlinecode"><span class="id" title="tactic">omega</span></span> tactic, which is capable of automatically proving some
    theorems about inequalities, succeeds.

<div class="paragraph"> </div>

    For the <span class="inlinecode"><span class="id" title="var">ReflectF</span></span> constructor, the guard <span class="inlinecode"><span class="id" title="var">a</span></span> <span class="inlinecode">&lt;?</span> <span class="inlinecode">5</span> must be equal
    to <span class="inlinecode"><span class="id" title="var">false</span></span>. So the <span class="inlinecode"><span class="id" title="keyword">if</span></span> expression simplifies to <span class="inlinecode">2</span> <span class="inlinecode">&lt;</span> <span class="inlinecode">6</span>, which is
    immediately provable by <span class="inlinecode"><span class="id" title="tactic">omega</span></span>. 
<div class="paragraph"> </div>

 A less didactic version of the above proof wouldn't do the
    <span class="inlinecode"><span class="id" title="tactic">assert</span></span> and <span class="inlinecode"><span class="id" title="var">remember</span></span>: we can directly skip to <span class="inlinecode"><span class="id" title="tactic">destruct</span></span>. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Example</span> <a id="reflect_example1'" class="idref" href="#reflect_example1'"><span class="id" title="definition">reflect_example1'</span></a>: <span class="id" title="keyword">∀</span> <a id="a:32" class="idref" href="#a:32"><span class="id" title="binder">a</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Peano.html#::nat_scope:x_'&lt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">if</span> <a class="idref" href="Perm.html#a:32"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Arith.PeanoNat.html#6b7621b45fff0af5e2b2cbb2bc2d4e1d"><span class="id" title="notation">&lt;?</span></a> 5 <span class="id" title="keyword">then</span> <a class="idref" href="Perm.html#a:32"><span class="id" title="variable">a</span></a> <span class="id" title="keyword">else</span> 2<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Peano.html#::nat_scope:x_'&lt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Peano.html#::nat_scope:x_'&lt;'_x"><span class="id" title="notation">&lt;</span></a> 6.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">a</span>. <span class="id" title="tactic">destruct</span> (<a class="idref" href="Perm.html#ltb_reflect"><span class="id" title="lemma">ltb_reflect</span></a> <span class="id" title="var">a</span> 5); <span class="id" title="tactic">omega</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
But even that proof is a little unsatisfactory. The original expression,
    <span class="inlinecode"><span class="id" title="var">a</span></span> <span class="inlinecode">&lt;?</span> <span class="inlinecode">5</span>, is not perfectly apparent from the expression <span class="inlinecode"><span class="id" title="var">ltb_reflect</span></span> <span class="inlinecode"><span class="id" title="var">a</span></span> <span class="inlinecode">5</span>
    that we pass to <span class="inlinecode"><span class="id" title="tactic">destruct</span></span>. 
<div class="paragraph"> </div>

 It would be nice to be able to just say something like <span class="inlinecode"><span class="id" title="tactic">destruct</span></span>
    <span class="inlinecode">(<span class="id" title="var">a</span></span> <span class="inlinecode">&lt;?</span> <span class="inlinecode">5)</span> and get the reflection "for free."  That's what we'll
    engineer, next. 
<div class="paragraph"> </div>

<a id="lab15"></a><h2 class="section">A Tactic for Boolean Destruction</h2>

<div class="paragraph"> </div>

 We're now going to build a tactic that you'll want to <i>use</i>, but
    you won't need to understand the details of how to <i>build</i> it
    yourself.

<div class="paragraph"> </div>

    Let's put several of these <span class="inlinecode"><span class="id" title="var">reflect</span></span> lemmas into a Hint database.
    We call it <span class="inlinecode"><span class="id" title="var">bdestruct</span></span>, because we'll use it in our
    boolean-destruction tactic: 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">ltb_reflect</span> <span class="id" title="var">leb_reflect</span> <span class="id" title="var">eqb_reflect</span> : <span class="id" title="var">bdestruct</span>.<br/>
</div>

<div class="doc">
Here is the tactic, the body of which you do not need to
    understand.  Invoking <span class="inlinecode"><span class="id" title="var">bdestruct</span></span> on Boolean expression <span class="inlinecode"><span class="id" title="var">b</span></span> does
    the same kind of reasoning we did above: reflection and
    destruction.  It also attempts to simplify negations involving
    inequalities in hypotheses. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">bdestruct</span> <span class="id" title="var">X</span> :=<br/>
<div class="togglescript" id="proofcontrol1" onclick="toggleDisplay('proof1');toggleDisplay('proofcontrol1')"><span class="show"></span></div>
<div class="proofscript" id="proof1" onclick="toggleDisplay('proof1');toggleDisplay('proofcontrol1')">
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">H</span> := <span class="id" title="tactic">fresh</span> <span class="id" title="tactic">in</span> <span class="id" title="keyword">let</span> <span class="id" title="var">e</span> := <span class="id" title="tactic">fresh</span> "e" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">evar</span> (<span class="id" title="var">e</span>: <span class="id" title="keyword">Prop</span>);<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">H</span>: <a class="idref" href="http://coq.inria.fr/library//Coq.Bool.Bool.html#reflect"><span class="id" title="inductive">reflect</span></a> <span class="id" title="var">e</span> <span class="id" title="var">X</span>); <span class="id" title="tactic">subst</span> <span class="id" title="var">e</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[<span class="id" title="tactic">eauto</span> <span class="id" title="keyword">with</span> <span class="id" title="var">bdestruct</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">H</span>|<span class="id" title="var">H</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ | <span class="id" title="tactic">try</span> <span class="id" title="tactic">first</span> [<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Arith.Compare_dec.html#not_lt"><span class="id" title="lemma">not_lt</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span> | <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Arith.Compare_dec.html#not_le"><span class="id" title="lemma">not_le</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>]]].<br/>
</div>
</div>

<div class="doc">
This tactic makes quick, easy-to-read work of our running example. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Example</span> <a id="reflect_example2" class="idref" href="#reflect_example2"><span class="id" title="definition">reflect_example2</span></a>: <span class="id" title="keyword">∀</span> <a id="a:33" class="idref" href="#a:33"><span class="id" title="binder">a</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Peano.html#::nat_scope:x_'&lt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="keyword">if</span> <a class="idref" href="Perm.html#a:33"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Arith.PeanoNat.html#6b7621b45fff0af5e2b2cbb2bc2d4e1d"><span class="id" title="notation">&lt;?</span></a> 5 <span class="id" title="keyword">then</span> <a class="idref" href="Perm.html#a:33"><span class="id" title="variable">a</span></a> <span class="id" title="keyword">else</span> 2<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Peano.html#::nat_scope:x_'&lt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Peano.html#::nat_scope:x_'&lt;'_x"><span class="id" title="notation">&lt;</span></a> 6.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">bdestruct</span> (<span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Arith.PeanoNat.html#6b7621b45fff0af5e2b2cbb2bc2d4e1d"><span class="id" title="notation">&lt;?</span></a> 5);  <span class="comment">(*&nbsp;instead&nbsp;of:&nbsp;<span class="inlinecode"><span class="id" title="tactic">destruct</span></span> <span class="inlinecode">(<span class="id" title="var">ltb_reflect</span></span> <span class="inlinecode"><span class="id" title="var">a</span></span> <span class="inlinecode">5)</span>.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">omega</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a id="lab16"></a><h2 class="section">Finishing the <span class="inlinecode"><span class="id" title="var">maybe_swap</span></span> Proof</h2>

<div class="paragraph"> </div>

 Now that we have <span class="inlinecode"><span class="id" title="var">bdestruct</span></span>, we can finish the proof of <span class="inlinecode"><span class="id" title="var">maybe_swap</span></span>'s
    idempotence. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a id="maybe_swap_idempotent" class="idref" href="#maybe_swap_idempotent"><span class="id" title="lemma">maybe_swap_idempotent</span></a>: <span class="id" title="keyword">∀</span> <a id="al:34" class="idref" href="#al:34"><span class="id" title="binder">al</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Perm.html#maybe_swap"><span class="id" title="definition">maybe_swap</span></a> (<a class="idref" href="Perm.html#maybe_swap"><span class="id" title="definition">maybe_swap</span></a> <a class="idref" href="Perm.html#al:34"><span class="id" title="variable">al</span></a>) <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="Perm.html#maybe_swap"><span class="id" title="definition">maybe_swap</span></a> <a class="idref" href="Perm.html#al:34"><span class="id" title="variable">al</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [ | <span class="id" title="var">a</span> [ | <span class="id" title="var">b</span> <span class="id" title="var">al</span>]]; <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">bdestruct</span> (<span class="id" title="var">a</span> <a class="idref" href="Perm.html#5ea9023a94e85f78711b2bf8cc72c8f<sub>4</sub>"><span class="id" title="notation">&gt;?</span></a> <span class="id" title="var">b</span>); <span class="id" title="tactic">simpl</span>.<br/>
</div>

<div class="doc">
Note how <span class="inlinecode"><span class="id" title="var">b</span></span> <span class="inlinecode">&lt;</span> <span class="inlinecode"><span class="id" title="var">a</span></span> is a hypothesis, rather than <span class="inlinecode"><span class="id" title="var">b</span></span> <span class="inlinecode">&lt;?</span> <span class="inlinecode"><span class="id" title="var">a</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">true</span></span>. 
</div>
<div class="code">
&nbsp;&nbsp;- <span class="id" title="var">bdestruct</span> (<span class="id" title="var">b</span> <a class="idref" href="Perm.html#5ea9023a94e85f78711b2bf8cc72c8f<sub>4</sub>"><span class="id" title="notation">&gt;?</span></a> <span class="id" title="var">a</span>); <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ </div>

<div class="doc">
<span class="inlinecode"><span class="id" title="tactic">omega</span></span> can take care of the contradictory propositional inequalities. 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">bdestruct</span> (<span class="id" title="var">a</span> <a class="idref" href="Perm.html#5ea9023a94e85f78711b2bf8cc72c8f<sub>4</sub>"><span class="id" title="notation">&gt;?</span></a> <span class="id" title="var">b</span>); <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">reflexivity</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
When proving theorems about a program that uses Boolean
    comparisons, use <span class="inlinecode"><span class="id" title="var">bdestruct</span></span> followed by <span class="inlinecode"><span class="id" title="tactic">omega</span></span>, rather than
    <span class="inlinecode"><span class="id" title="tactic">destruct</span></span> followed by application of various theorems about
    Boolean operators. 
</div>

<div class="doc">
<a id="lab17"></a><h1 class="section">Permutations</h1>

<div class="paragraph"> </div>

 Another useful fact about <span class="inlinecode"><span class="id" title="var">maybe_swap</span></span> is that it doesn't add or
    remove elements from the list: it only reorders them.  That is,
    the output list is a permutation of the input.  List <span class="inlinecode"><span class="id" title="var">al</span></span> is a
    <i>permutation</i> of list <span class="inlinecode"><span class="id" title="var">bl</span></span> if the elements of <span class="inlinecode"><span class="id" title="var">al</span></span> can be
    reordered to get the list <span class="inlinecode"><span class="id" title="var">bl</span></span>.  Note that reordering does not
    permit adding or removing duplicate elements. 
<div class="paragraph"> </div>

 Coq's <span class="inlinecode"><span class="id" title="var">Permutation</span></span> library has an inductive definition of
    permutations. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Print</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Sorting.Permutation.html#Permutation"><span class="id" title="inductive">Permutation</span></a>.<br/><hr class='doublespaceincode'/>
<span class="comment">(*<br/>
&nbsp;Inductive&nbsp;Permutation&nbsp;{A&nbsp;:&nbsp;Type}&nbsp;:&nbsp;list&nbsp;A&nbsp;<span class="nowrap"><span style='font-size:85%;'><span style='vertical-align:5%;'><span style='letter-spacing:-.2em;'>-</span></span>&gt;</span></span>&nbsp;list&nbsp;A&nbsp;<span class="nowrap"><span style='font-size:85%;'><span style='vertical-align:5%;'><span style='letter-spacing:-.2em;'>-</span></span>&gt;</span></span>&nbsp;Prop&nbsp;:=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;perm_nil&nbsp;:&nbsp;Permutation&nbsp;<span class="inlinecode"></span>&nbsp;<span class="inlinecode"></span><br/>
&nbsp;&nbsp;|&nbsp;perm_skip&nbsp;:&nbsp;forall&nbsp;(x&nbsp;:&nbsp;A)&nbsp;(l&nbsp;l'&nbsp;:&nbsp;list&nbsp;A),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Permutation&nbsp;l&nbsp;l'&nbsp;<span class="nowrap"><span style='font-size:85%;'><span style='vertical-align:5%;'><span style='letter-spacing:-.2em;'>-</span></span>&gt;</span></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Permutation&nbsp;(x&nbsp;::&nbsp;l)&nbsp;(x&nbsp;::&nbsp;l')<br/>
&nbsp;&nbsp;|&nbsp;perm_swap&nbsp;:&nbsp;forall&nbsp;(x&nbsp;y&nbsp;:&nbsp;A)&nbsp;(l&nbsp;:&nbsp;list&nbsp;A),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Permutation&nbsp;(y&nbsp;::&nbsp;x&nbsp;::&nbsp;l)&nbsp;(x&nbsp;::&nbsp;y&nbsp;::&nbsp;l)<br/>
&nbsp;&nbsp;|&nbsp;perm_trans&nbsp;:&nbsp;forall&nbsp;l&nbsp;l'&nbsp;l''&nbsp;:&nbsp;list&nbsp;A,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Permutation&nbsp;l&nbsp;l'&nbsp;<span class="nowrap"><span style='font-size:85%;'><span style='vertical-align:5%;'><span style='letter-spacing:-.2em;'>-</span></span>&gt;</span></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Permutation&nbsp;l'&nbsp;l''&nbsp;<span class="nowrap"><span style='font-size:85%;'><span style='vertical-align:5%;'><span style='letter-spacing:-.2em;'>-</span></span>&gt;</span></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Permutation&nbsp;l&nbsp;l''.<br/>
&nbsp;*)</span><br/>
</div>

<div class="doc">
You might wonder, "is that really the right definition?"  And
    indeed, it's important that we get a right definition, because
    <span class="inlinecode"><span class="id" title="var">Permutation</span></span> is going to be used in our specifications of
    searching and sorting algorithms.  If we have the wrong
    specification, then all our proofs of "correctness" will be
    useless.

<div class="paragraph"> </div>

    It's not obvious that this is indeed the right specification of
    permutations. (It happens to be, but that's not obvious.) To gain
    confidence that we have the right specification, let's use it
    prove some properties that permutations ought to have. 
<div class="paragraph"> </div>

<a id="lab18"></a><h4 class="section">Exercise: 2 stars, standard (Permutation_properties)</h4>
 Think of some desirable properties of the <span class="inlinecode"><span class="id" title="var">Permutation</span></span> relation
    and write them down informally in English, or a mix of Coq and
    English.  Here are four to get you started:

<div class="paragraph"> </div>

<ul class="doclist">
<li> 1. If <span class="inlinecode"><span class="id" title="var">Permutation</span></span> <span class="inlinecode"><span class="id" title="var">al</span></span> <span class="inlinecode"><span class="id" title="var">bl</span></span>, then <span class="inlinecode"><span class="id" title="var">length</span></span> <span class="inlinecode"><span class="id" title="var">al</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">length</span></span> <span class="inlinecode"><span class="id" title="var">bl</span></span>.

</li>
<li> 2. If <span class="inlinecode"><span class="id" title="var">Permutation</span></span> <span class="inlinecode"><span class="id" title="var">al</span></span> <span class="inlinecode"><span class="id" title="var">bl</span></span>, then <span class="inlinecode"><span class="id" title="var">Permutation</span></span> <span class="inlinecode"><span class="id" title="var">bl</span></span> <span class="inlinecode"><span class="id" title="var">al</span></span>.

</li>
<li> 3. <span class="inlinecode">[1;1]</span> is NOT a permutation of <span class="inlinecode">[1;2]</span>.

</li>
<li> 4. <span class="inlinecode">[1;2;3;4]</span> IS a permutation of <span class="inlinecode">[3;4;2;1]</span>.

</li>
</ul>

<div class="paragraph"> </div>

   YOUR TASK: Add three more properties. Write them here: 
<div class="paragraph"> </div>

 Now, let's examine all the theorems in the Coq library about
    permutations: 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Search</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Sorting.Permutation.html#Permutation"><span class="id" title="inductive">Permutation</span></a>. <span class="comment">(*&nbsp;Browse&nbsp;through&nbsp;the&nbsp;results&nbsp;of&nbsp;this&nbsp;query!&nbsp;*)</span><br/>
</div>

<div class="doc">
Which of the properties that you wrote down above have already
    been proved as theorems by the Coq library developers?  Answer
    here:

<div class="paragraph"> </div>


</div>
<div class="code">
<span class="comment">(*&nbsp;Do&nbsp;not&nbsp;modify&nbsp;the&nbsp;following&nbsp;line:&nbsp;*)</span><br/>
<span class="id" title="keyword">Definition</span> <a id="manual_grade_for_Permutation_properties" class="idref" href="#manual_grade_for_Permutation_properties"><span class="id" title="definition">manual_grade_for_Permutation_properties</span></a> : <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> (<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac<sub>4</sub>"><span class="id" title="notation">×</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Strings.String.html#string"><span class="id" title="inductive">string</span></a>) := <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="doc"> 
<div class="paragraph"> </div>

 Let's use the permutation theorems in the library to prove the
    following theorem. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Example</span> <a id="butterfly" class="idref" href="#butterfly"><span class="id" title="definition">butterfly</span></a>: <span class="id" title="keyword">∀</span> <a id="b:35" class="idref" href="#b:35"><span class="id" title="binder">b</span></a> <a id="u:36" class="idref" href="#u:36"><span class="id" title="binder">u</span></a> <a id="t:37" class="idref" href="#t:37"><span class="id" title="binder">t</span></a> <a id="e:38" class="idref" href="#e:38"><span class="id" title="binder">e</span></a> <a id="r:39" class="idref" href="#r:39"><span class="id" title="binder">r</span></a> <a id="f:40" class="idref" href="#f:40"><span class="id" title="binder">f</span></a> <a id="l:41" class="idref" href="#l:41"><span class="id" title="binder">l</span></a> <a id="y:42" class="idref" href="#y:42"><span class="id" title="binder">y</span></a> : <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Sorting.Permutation.html#Permutation"><span class="id" title="inductive">Permutation</span></a> (<a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">[</span></a><a class="idref" href="Perm.html#b:35"><span class="id" title="variable">b</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><a class="idref" href="Perm.html#u:36"><span class="id" title="variable">u</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><a class="idref" href="Perm.html#t:37"><span class="id" title="variable">t</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><a class="idref" href="Perm.html#t:37"><span class="id" title="variable">t</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><a class="idref" href="Perm.html#e:38"><span class="id" title="variable">e</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><a class="idref" href="Perm.html#r:39"><span class="id" title="variable">r</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">]</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c<sub>6</sub>"><span class="id" title="notation">++</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">[</span></a><a class="idref" href="Perm.html#f:40"><span class="id" title="variable">f</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><a class="idref" href="Perm.html#l:41"><span class="id" title="variable">l</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><a class="idref" href="Perm.html#y:42"><span class="id" title="variable">y</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">]</span></a>) (<a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">[</span></a><a class="idref" href="Perm.html#f:40"><span class="id" title="variable">f</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><a class="idref" href="Perm.html#l:41"><span class="id" title="variable">l</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><a class="idref" href="Perm.html#u:36"><span class="id" title="variable">u</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><a class="idref" href="Perm.html#t:37"><span class="id" title="variable">t</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><a class="idref" href="Perm.html#t:37"><span class="id" title="variable">t</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><a class="idref" href="Perm.html#e:38"><span class="id" title="variable">e</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><a class="idref" href="Perm.html#r:39"><span class="id" title="variable">r</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">]</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c<sub>6</sub>"><span class="id" title="notation">++</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">[</span></a><a class="idref" href="Perm.html#b:35"><span class="id" title="variable">b</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><a class="idref" href="Perm.html#y:42"><span class="id" title="variable">y</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">]</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
</div>

<div class="doc">
Let's group <span class="inlinecode">[<span class="id" title="var">u</span>;<span class="id" title="var">t</span>;<span class="id" title="var">t</span>;<span class="id" title="var">e</span>;<span class="id" title="var">r</span>]</span> together on both sides.  Tactic
      <span class="inlinecode"><span class="id" title="tactic">change</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode"><span class="id" title="keyword">with</span></span> <span class="inlinecode"><span class="id" title="var">u</span></span> replaces <span class="inlinecode"><span class="id" title="var">t</span></span> with <span class="inlinecode"><span class="id" title="var">u</span></span>.  Terms <span class="inlinecode"><span class="id" title="var">t</span></span> and <span class="inlinecode"><span class="id" title="var">u</span></span> must
      be <i>convertible</i>, here meaning that they evalute to the same
      term. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="tactic">change</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">[</span></a><span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><span class="id" title="var">u</span><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><span class="id" title="var">t</span><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><span class="id" title="var">t</span><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><span class="id" title="var">e</span><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><span class="id" title="var">r</span><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">]</span></a> <span class="id" title="keyword">with</span> (<a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c<sub>6</sub>"><span class="id" title="notation">++</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">[</span></a><span class="id" title="var">u</span><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><span class="id" title="var">t</span><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><span class="id" title="var">t</span><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><span class="id" title="var">e</span><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><span class="id" title="var">r</span><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">]</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">change</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">[</span></a><span class="id" title="var">f</span><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><span class="id" title="var">l</span><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><span class="id" title="var">u</span><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><span class="id" title="var">t</span><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><span class="id" title="var">t</span><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><span class="id" title="var">e</span><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><span class="id" title="var">r</span><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">]</span></a> <span class="id" title="keyword">with</span> (<a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">[</span></a><span class="id" title="var">f</span><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><span class="id" title="var">l</span><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">]</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c<sub>6</sub>"><span class="id" title="notation">++</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">[</span></a><span class="id" title="var">u</span><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><span class="id" title="var">t</span><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><span class="id" title="var">t</span><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><span class="id" title="var">e</span><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><span class="id" title="var">r</span><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">]</span></a>).<br/>
</div>

<div class="doc">
We don't actually need to know the list elements in
      <span class="inlinecode">[<span class="id" title="var">u</span>;<span class="id" title="var">t</span>;<span class="id" title="var">t</span>;<span class="id" title="var">e</span>;<span class="id" title="var">r</span>]</span>.  Let's forget about them and just remember them
      as a variable named <span class="inlinecode"><span class="id" title="var">utter</span></span>. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="var">remember</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">[</span></a><span class="id" title="var">u</span><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><span class="id" title="var">t</span><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><span class="id" title="var">t</span><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><span class="id" title="var">e</span><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><span class="id" title="var">r</span><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">]</span></a> <span class="id" title="keyword">as</span> <span class="id" title="var">utter</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">Hequtter</span>.<br/>
</div>

<div class="doc">
Likewise, let's group <span class="inlinecode">[<span class="id" title="var">f</span>;<span class="id" title="var">l</span>]</span> and remember it as a variable. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="tactic">change</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">[</span></a><span class="id" title="var">f</span><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><span class="id" title="var">l</span><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><span class="id" title="var">y</span><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">]</span></a> <span class="id" title="keyword">with</span> (<a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">[</span></a><span class="id" title="var">f</span><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><span class="id" title="var">l</span><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">]</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c<sub>6</sub>"><span class="id" title="notation">++</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><span class="id" title="var">y</span><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="var">remember</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">[</span></a><span class="id" title="var">f</span><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><span class="id" title="var">l</span><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">]</span></a> <span class="id" title="keyword">as</span> <span class="id" title="var">fl</span>. <span class="id" title="tactic">clear</span> <span class="id" title="var">Heqfl</span>.<br/>
</div>

<div class="doc">
Next, let's cancel <span class="inlinecode"><span class="id" title="var">fl</span></span> from both sides.  In order to do that,
      we need to bring it to the beginning of each list. For the right
      list, that follows easily from the associativity of <span class="inlinecode">++</span>.  
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c<sub>6</sub>"><span class="id" title="notation">(</span></a><span class="id" title="var">fl</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c<sub>6</sub>"><span class="id" title="notation">++</span></a> <span class="id" title="var">utter</span><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c<sub>6</sub>"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c<sub>6</sub>"><span class="id" title="notation">++</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">[</span></a><span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><span class="id" title="var">y</span><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">]</span></a>) <span class="id" title="keyword">with</span> (<span class="id" title="var">fl</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c<sub>6</sub>"><span class="id" title="notation">++</span></a> <span class="id" title="var">utter</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c<sub>6</sub>"><span class="id" title="notation">++</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">[</span></a><span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a><span class="id" title="var">y</span><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">]</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#app_assoc"><span class="id" title="lemma">app_assoc</span></a>.<br/>
</div>

<div class="doc">
But for the left list, we can't just use associativity.
      Instead, we need to reason about permutations and use some
      library theorems. 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Sorting.Permutation.html#perm_trans"><span class="id" title="constructor">perm_trans</span></a> <span class="id" title="keyword">with</span> (<span class="id" title="var">fl</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c<sub>6</sub>"><span class="id" title="notation">++</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><span class="id" title="var">y</span><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c<sub>6</sub>"><span class="id" title="notation">++</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c<sub>6</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c<sub>6</sub>"><span class="id" title="notation">++</span></a> <span class="id" title="var">utter</span><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c<sub>6</sub>"><span class="id" title="notation">)</span></a>).<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">replace</span> (<span class="id" title="var">fl</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c<sub>6</sub>"><span class="id" title="notation">++</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><span class="id" title="var">y</span><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c<sub>6</sub>"><span class="id" title="notation">++</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c<sub>6</sub>"><span class="id" title="notation">++</span></a> <span class="id" title="var">utter</span>) <span class="id" title="keyword">with</span> (<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c<sub>6</sub>"><span class="id" title="notation">(</span></a><span class="id" title="var">fl</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c<sub>6</sub>"><span class="id" title="notation">++</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><span class="id" title="var">y</span><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c<sub>6</sub>"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c<sub>6</sub>"><span class="id" title="notation">++</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c<sub>6</sub>"><span class="id" title="notation">++</span></a> <span class="id" title="var">utter</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Sorting.Permutation.html#Permutation_app_comm"><span class="id" title="lemma">Permutation_app_comm</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#app_assoc"><span class="id" title="lemma">app_assoc</span></a>. <span class="id" title="tactic">reflexivity</span>.<br/><hr class='doublespaceincode'/>
&nbsp;&nbsp;- </div>

<div class="doc">
A library theorem will now help us cancel <span class="inlinecode"><span class="id" title="var">fl</span></span>. 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Sorting.Permutation.html#Permutation_app_head"><span class="id" title="lemma">Permutation_app_head</span></a>.<br/>
</div>

<div class="doc">
Next let's cancel <span class="inlinecode"><span class="id" title="var">utter</span></span>. 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Sorting.Permutation.html#perm_trans"><span class="id" title="constructor">perm_trans</span></a> <span class="id" title="keyword">with</span> (<span class="id" title="var">utter</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c<sub>6</sub>"><span class="id" title="notation">++</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><span class="id" title="var">y</span><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c<sub>6</sub>"><span class="id" title="notation">++</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">replace</span> (<a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><span class="id" title="var">y</span><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c<sub>6</sub>"><span class="id" title="notation">++</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c<sub>6</sub>"><span class="id" title="notation">++</span></a> <span class="id" title="var">utter</span>) <span class="id" title="keyword">with</span> (<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c<sub>6</sub>"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><span class="id" title="var">y</span><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c<sub>6</sub>"><span class="id" title="notation">++</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">[</span></a><span class="id" title="var">b</span><a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#ddd65c2f7ee73ecec433744948d846bb"><span class="id" title="notation">]</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c<sub>6</sub>"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c<sub>6</sub>"><span class="id" title="notation">++</span></a> <span class="id" title="var">utter</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Sorting.Permutation.html#Permutation_app_comm"><span class="id" title="lemma">Permutation_app_comm</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;× <span class="id" title="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#app_assoc"><span class="id" title="lemma">app_assoc</span></a>. <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Sorting.Permutation.html#Permutation_app_head"><span class="id" title="lemma">Permutation_app_head</span></a>.<br/>
</div>

<div class="doc">
Finally we're left with just <span class="inlinecode"><span class="id" title="var">y</span></span> and <span class="inlinecode"><span class="id" title="var">b</span></span>. 
</div>
<div class="code">
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Sorting.Permutation.html#perm_swap"><span class="id" title="constructor">perm_swap</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
That example illustrates a general method for proving permutations
    involving cons <span class="inlinecode">::</span> and append <span class="inlinecode">++</span>:

<div class="paragraph"> </div>

<ul class="doclist">
<li> Identify some portion appearing in both sides.

</li>
<li> Bring that portion to the front on each side using lemmas such
      as <span class="inlinecode"><span class="id" title="var">Permutation_app_comm</span></span> and <span class="inlinecode"><span class="id" title="var">perm_swap</span></span>, with generous use of
      <span class="inlinecode"><span class="id" title="var">perm_trans</span></span>.

</li>
<li> Use <span class="inlinecode"><span class="id" title="var">Permutation_app_head</span></span> to cancel an appended head.  You can
      also use <span class="inlinecode"><span class="id" title="var">perm_skip</span></span> to cancel a single element. 
</li>
</ul>

<div class="paragraph"> </div>

<a id="lab19"></a><h4 class="section">Exercise: 3 stars, standard (permut_example)</h4>
 Use the permutation rules in the library to prove the following
    theorem.  The following <span class="inlinecode"><span class="id" title="keyword">Check</span></span> commands are a hint about useful
    lemmas.  You don't need all of them, and depending on your
    approach you will find lemmas to be more useful than others. Use
    <span class="inlinecode"><span class="id" title="keyword">Search</span></span> <span class="inlinecode"><span class="id" title="var">Permutation</span></span> to find others, if you like. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Check</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Sorting.Permutation.html#perm_skip"><span class="id" title="constructor">perm_skip</span></a>.<br/>
<span class="id" title="keyword">Check</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Sorting.Permutation.html#perm_trans"><span class="id" title="constructor">perm_trans</span></a>.<br/>
<span class="id" title="keyword">Check</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Sorting.Permutation.html#Permutation_refl"><span class="id" title="lemma">Permutation_refl</span></a>.<br/>
<span class="id" title="keyword">Check</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Sorting.Permutation.html#Permutation_app_comm"><span class="id" title="lemma">Permutation_app_comm</span></a>.<br/>
<span class="id" title="keyword">Check</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#app_assoc"><span class="id" title="lemma">app_assoc</span></a>.<br/>
<span class="id" title="keyword">Check</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#app_nil_r"><span class="id" title="lemma">app_nil_r</span></a>.<br/>
<span class="id" title="keyword">Check</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#app_comm_cons"><span class="id" title="lemma">app_comm_cons</span></a>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Example</span> <a id="permut_example" class="idref" href="#permut_example"><span class="id" title="definition">permut_example</span></a>: <span class="id" title="keyword">∀</span> (<a id="a:43" class="idref" href="#a:43"><span class="id" title="binder">a</span></a> <a id="b:44" class="idref" href="#b:44"><span class="id" title="binder">b</span></a>: <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>),<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Sorting.Permutation.html#Permutation"><span class="id" title="inductive">Permutation</span></a> (5 <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> 6 <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <a class="idref" href="Perm.html#a:43"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c<sub>6</sub>"><span class="id" title="notation">++</span></a> <a class="idref" href="Perm.html#b:44"><span class="id" title="variable">b</span></a>) (<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c<sub>6</sub>"><span class="id" title="notation">(</span></a>5 <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <a class="idref" href="Perm.html#b:44"><span class="id" title="variable">b</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c<sub>6</sub>"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c<sub>6</sub>"><span class="id" title="notation">++</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c<sub>6</sub>"><span class="id" title="notation">(</span></a>6 <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <a class="idref" href="Perm.html#a:43"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c<sub>6</sub>"><span class="id" title="notation">++</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a><a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c<sub>6</sub>"><span class="id" title="notation">)</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="doc"> 
<div class="paragraph"> </div>

<a id="lab20"></a><h4 class="section">Exercise: 2 stars, standard (not_a_permutation)</h4>
 Prove that <span class="inlinecode">[1;1]</span> is not a permutation of <span class="inlinecode">[1;2]</span>.
    Hints are given as <span class="inlinecode"><span class="id" title="keyword">Check</span></span> commands. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Check</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Sorting.Permutation.html#Permutation_cons_inv"><span class="id" title="lemma">Permutation_cons_inv</span></a>.<br/>
<span class="id" title="keyword">Check</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Sorting.Permutation.html#Permutation_length_1_inv"><span class="id" title="lemma">Permutation_length_1_inv</span></a>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Example</span> <a id="not_a_permutation" class="idref" href="#not_a_permutation"><span class="id" title="definition">not_a_permutation</span></a>:<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#63a68285c81db8f9bc456233bb9ed181"><span class="id" title="notation">¬</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Sorting.Permutation.html#Permutation"><span class="id" title="inductive">Permutation</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">[</span></a>1<a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a>1<a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">]</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">[</span></a>1<a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">;</span></a>2<a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#e76c6291366b599375c28eba0aae94bb"><span class="id" title="notation">]</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="doc"> 
<div class="paragraph"> </div>

<a id="lab21"></a><h2 class="section">Correctness of <span class="inlinecode"><span class="id" title="var">maybe_swap</span></span></h2>

<div class="paragraph"> </div>

 Now we can prove that <span class="inlinecode"><span class="id" title="var">maybe_swap</span></span> is a permutation: it reorders
    elements but does not add or remove any. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a id="maybe_swap_perm" class="idref" href="#maybe_swap_perm"><span class="id" title="lemma">maybe_swap_perm</span></a>: <span class="id" title="keyword">∀</span> <a id="al:45" class="idref" href="#al:45"><span class="id" title="binder">al</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Sorting.Permutation.html#Permutation"><span class="id" title="inductive">Permutation</span></a> <a class="idref" href="Perm.html#al:45"><span class="id" title="variable">al</span></a> (<a class="idref" href="Perm.html#maybe_swap"><span class="id" title="definition">maybe_swap</span></a> <a class="idref" href="Perm.html#al:45"><span class="id" title="variable">al</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;WORKED&nbsp;IN&nbsp;CLASS&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="Perm.html#maybe_swap"><span class="id" title="definition">maybe_swap</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">al</span> <span class="id" title="keyword">as</span> [ | <span class="id" title="var">a</span> [ | <span class="id" title="var">b</span> <span class="id" title="var">al</span>]].<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">simpl</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Sorting.Permutation.html#perm_nil"><span class="id" title="constructor">perm_nil</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Sorting.Permutation.html#Permutation_refl"><span class="id" title="lemma">Permutation_refl</span></a>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">bdestruct</span> (<span class="id" title="var">b</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Arith.PeanoNat.html#6b7621b45fff0af5e2b2cbb2bc2d4e1d"><span class="id" title="notation">&lt;?</span></a> <span class="id" title="var">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Sorting.Permutation.html#perm_swap"><span class="id" title="constructor">perm_swap</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Sorting.Permutation.html#Permutation_refl"><span class="id" title="lemma">Permutation_refl</span></a>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
And, we can prove that <span class="inlinecode"><span class="id" title="var">maybe_swap</span></span> permutes elements such that
    the first is less than or equal to the second. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a id="first_le_second" class="idref" href="#first_le_second"><span class="id" title="definition">first_le_second</span></a> (<a id="al:46" class="idref" href="#al:46"><span class="id" title="binder">al</span></a>: <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a>) : <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Perm.html#al:46"><span class="id" title="variable">al</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <span class="id" title="var">b</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <span class="id" title="var">_</span> ⇒ <span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Peano.html#cb53cf0ee22c036a03b4a9281c68b5a<sub>3</sub>"><span class="id" title="notation">≤</span></a> <span class="id" title="var">b</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> ⇒ <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#True"><span class="id" title="inductive">True</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/><hr class='doublespaceincode'/>
<span class="id" title="keyword">Theorem</span> <a id="maybe_swap_correct" class="idref" href="#maybe_swap_correct"><span class="id" title="lemma">maybe_swap_correct</span></a>: <span class="id" title="keyword">∀</span> <a id="al:48" class="idref" href="#al:48"><span class="id" title="binder">al</span></a>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Sorting.Permutation.html#Permutation"><span class="id" title="inductive">Permutation</span></a> <a class="idref" href="Perm.html#al:48"><span class="id" title="variable">al</span></a> (<a class="idref" href="Perm.html#maybe_swap"><span class="id" title="definition">maybe_swap</span></a> <a class="idref" href="Perm.html#al:48"><span class="id" title="variable">al</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">∧</span></a> <a class="idref" href="Perm.html#first_le_second"><span class="id" title="definition">first_le_second</span></a> (<a class="idref" href="Perm.html#maybe_swap"><span class="id" title="definition">maybe_swap</span></a> <a class="idref" href="Perm.html#al:48"><span class="id" title="variable">al</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="Perm.html#maybe_swap_perm"><span class="id" title="lemma">maybe_swap_perm</span></a>.<br/>
&nbsp;&nbsp;- <span class="comment">(*&nbsp;WORKED&nbsp;IN&nbsp;CLASS&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="Perm.html#maybe_swap"><span class="id" title="definition">maybe_swap</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">al</span> <span class="id" title="keyword">as</span> [ | <span class="id" title="var">a</span> [ | <span class="id" title="var">b</span> <span class="id" title="var">al</span>]]; <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">bdestruct</span> (<span class="id" title="var">a</span> <a class="idref" href="Perm.html#5ea9023a94e85f78711b2bf8cc72c8f<sub>4</sub>"><span class="id" title="notation">&gt;?</span></a> <span class="id" title="var">b</span>); <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">omega</span>.<br/>
<span class="id" title="keyword">Qed</span>.<br/>
</div>

<div class="doc">
<a id="lab22"></a><h1 class="section">Summary: Comparisons and Permutations</h1>

<div class="paragraph"> </div>

 To prove correctness of algorithms for sorting and searching,
    we'll reason about comparisons and permutations using the tools
    developed in this chapter.  The <span class="inlinecode"><span class="id" title="var">maybe_swap</span></span> program is a tiny
    little example of a sorting program.  The proof style in
    <span class="inlinecode"><span class="id" title="var">maybe_swap_correct</span></span> will be applied (at a larger scale) in
    the next few chapters. 
<div class="paragraph"> </div>

<a id="lab23"></a><h4 class="section">Exercise: 3 stars, standard (Forall_perm)</h4>
 To close, we define a utility tactic and lemma.  First, the
    tactic. 
<div class="paragraph"> </div>

 Coq's <span class="inlinecode"><span class="id" title="tactic">inversion</span></span> <span class="inlinecode"><span class="id" title="var">H</span></span> tactic is so good at extracting
    information from the hypothesis <span class="inlinecode"><span class="id" title="var">H</span></span> that <span class="inlinecode"><span class="id" title="var">H</span></span> sometimes becomes
    completely redundant, and one might as well <span class="inlinecode"><span class="id" title="tactic">clear</span></span> it from the
    goal.  Then, since the <span class="inlinecode"><span class="id" title="tactic">inversion</span></span> typically creates some equality
    facts, why not then <span class="inlinecode"><span class="id" title="tactic">subst</span></span> ?  Tactic <span class="inlinecode"><span class="id" title="var">inv</span></span> does just that. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">inv</span> <span class="id" title="var">H</span> := <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">subst</span>.<br/>
</div>

<div class="doc">
Second, the lemma.  You will find <span class="inlinecode"><span class="id" title="var">inv</span></span> useful in proving it.

<div class="paragraph"> </div>

    <span class="inlinecode"><span class="id" title="var">Forall</span></span> is Coq library's version of the <span class="inlinecode"><span class="id" title="keyword">All</span></span> proposition defined
    in <a href="https://softwarefoundations.cis.upenn.edu/lf-current/Logic.html"><span class="inlineref">Logic</span></a>, but defined as an inductive proposition rather
    than a fixpoint.  Prove this lemma by induction.  You will need to
    decide what to induct on: <span class="inlinecode"><span class="id" title="var">al</span></span>, <span class="inlinecode"><span class="id" title="var">bl</span></span>, <span class="inlinecode"><span class="id" title="var">Permutation</span></span> <span class="inlinecode"><span class="id" title="var">al</span></span> <span class="inlinecode"><span class="id" title="var">bl</span></span>, and
    <span class="inlinecode"><span class="id" title="var">Forall</span></span> <span class="inlinecode"><span class="id" title="var">f</span></span> <span class="inlinecode"><span class="id" title="var">al</span></span> are possibilities. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Theorem</span> <a id="Forall_perm" class="idref" href="#Forall_perm"><span class="id" title="lemma">Forall_perm</span></a>: <span class="id" title="keyword">∀</span> {<a id="A:49" class="idref" href="#A:49"><span class="id" title="binder">A</span></a>} (<a id="f:50" class="idref" href="#f:50"><span class="id" title="binder">f</span></a>: <a class="idref" href="Perm.html#A:49"><span class="id" title="variable">A</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <span class="id" title="keyword">Prop</span>) <a id="al:51" class="idref" href="#al:51"><span class="id" title="binder">al</span></a> <a id="bl:52" class="idref" href="#bl:52"><span class="id" title="binder">bl</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Sorting.Permutation.html#Permutation"><span class="id" title="inductive">Permutation</span></a> <a class="idref" href="Perm.html#al:51"><span class="id" title="variable">al</span></a> <a class="idref" href="Perm.html#bl:52"><span class="id" title="variable">bl</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> <a class="idref" href="Perm.html#f:50"><span class="id" title="variable">f</span></a> <a class="idref" href="Perm.html#al:51"><span class="id" title="variable">al</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">→</span></a> <a class="idref" href="http://coq.inria.fr/library//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> <a class="idref" href="Perm.html#f:50"><span class="id" title="variable">f</span></a> <a class="idref" href="Perm.html#bl:52"><span class="id" title="variable">bl</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;FILL&nbsp;IN&nbsp;HERE&nbsp;*)</span> <span class="id" title="var">Admitted</span>.<br/>
<font size=-2>&#9744;</font>
</div>

<div class="code">

<br/>
<span class="comment">(*&nbsp;2020-08-07&nbsp;17:08&nbsp;*)</span><br/>
</div>
</div>

<div id="footer">
<hr/><a href="coqindex.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>