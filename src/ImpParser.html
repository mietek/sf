<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<link href="coqdoc.css" rel="stylesheet" type="text/css"/>
<title>ImpParser: Lexing and Parsing in Coq</title>
<script type="text/javascript" src="jquery-1.8.3.js"></script>
<script type="text/javascript" src="main.js"></script>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">ImpParser<span class="subtitle">Lexing and Parsing in Coq</span></h1>

<div class="code code-tight">
</div>

<div class="doc">

<div class="paragraph"> </div>

 The development of the Imp language in <span class="inlinecode"><span class="id" type="var">Imp.v</span></span> completely ignores
    issues of concrete syntax &mdash; how an ascii string that a programmer
    might write gets translated into abstract syntax trees defined by
    the datatypes <span class="inlinecode"><span class="id" type="var">aexp</span></span>, <span class="inlinecode"><span class="id" type="var">bexp</span></span>, and <span class="inlinecode"><span class="id" type="var">com</span></span>.  In this chapter, we
    illustrate how the rest of the story can be filled in by building
    a simple lexical analyzer and parser using Coq's functional
    programming facilities.

<div class="paragraph"> </div>

    It is not important to understand all the details here (and
    accordingly, the explanations are fairly terse and there are no
    exercises).  The main point is simply to demonstrate that it can
    be done.  You are invited to look through the code &mdash; most of it
    is not very complicated, though the parser relies on some
    "monadic" programming idioms that may require a little work to
    make out &mdash; but most readers will probably want to just skim down
    to the Examples section at the very end to get the punchline. 
</div>
<div class="code code-tight">

<br/>
</div>

<div class="doc">
<a name="lab345"></a><h1 class="section">Internals</h1>

</div>
<div class="code code-space">

<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/library/Coq.Strings.String.html#"><span class="id" type="library">Coq.Strings.String</span></a>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/library/Coq.Strings.Ascii.html#"><span class="id" type="library">Coq.Strings.Ascii</span></a>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/library/Coq.Arith.Arith.html#"><span class="id" type="library">Coq.Arith.Arith</span></a>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/library/Coq.Arith.EqNat.html#"><span class="id" type="library">Coq.Arith.EqNat</span></a>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/library/Coq.Lists.List.html#"><span class="id" type="library">Coq.Lists.List</span></a>.<br/>
<span class="id" type="keyword">Import</span> <span class="id" type="var">ListNotations</span>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <a class="idref" href="Maps.html#"><span class="id" type="library">Maps</span></a>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <a class="idref" href="Imp.html#"><span class="id" type="library">Imp</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab346"></a><h2 class="section">Lexical Analysis</h2>

</div>
<div class="code code-space">

<br/>
<span class="id" type="keyword">Definition</span> <a name="isWhite"><span class="id" type="definition">isWhite</span></a> (<span class="id" type="var">c</span> : <a class="idref" href="http://coq.inria.fr/library/Coq.Strings.Ascii.html#ascii"><span class="id" type="inductive">ascii</span></a>) : <a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool"><span class="id" type="inductive">bool</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">n</span> := <a class="idref" href="http://coq.inria.fr/library/Coq.Strings.Ascii.html#nat_of_ascii"><span class="id" type="definition">nat_of_ascii</span></a> <a class="idref" href="ImpParser.html#c"><span class="id" type="variable">c</span></a> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#orb"><span class="id" type="definition">orb</span></a> (<a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#orb"><span class="id" type="definition">orb</span></a> (<a class="idref" href="http://coq.inria.fr/library/Coq.Arith.EqNat.html#beq_nat"><span class="id" type="abbreviation">beq_nat</span></a> <a class="idref" href="ImpParser.html#n"><span class="id" type="variable">n</span></a> 32)   <span class="comment">(*&nbsp;space&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="http://coq.inria.fr/library/Coq.Arith.EqNat.html#beq_nat"><span class="id" type="abbreviation">beq_nat</span></a> <a class="idref" href="ImpParser.html#n"><span class="id" type="variable">n</span></a> 9))   <span class="comment">(*&nbsp;tab&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#orb"><span class="id" type="definition">orb</span></a> (<a class="idref" href="http://coq.inria.fr/library/Coq.Arith.EqNat.html#beq_nat"><span class="id" type="abbreviation">beq_nat</span></a> <a class="idref" href="ImpParser.html#n"><span class="id" type="variable">n</span></a> 10)   <span class="comment">(*&nbsp;linefeed&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="http://coq.inria.fr/library/Coq.Arith.EqNat.html#beq_nat"><span class="id" type="abbreviation">beq_nat</span></a> <a class="idref" href="ImpParser.html#n"><span class="id" type="variable">n</span></a> 13)). <span class="comment">(*&nbsp;Carriage&nbsp;return.&nbsp;*)</span><br/>

<br/>
<span class="id" type="keyword">Notation</span> "x '&lt;=?' y" := (<a class="idref" href="http://coq.inria.fr/library/Coq.Arith.Compare_dec.html#leb"><span class="id" type="abbreviation">leb</span></a> <span class="id" type="var">x</span> <span class="id" type="var">y</span>)<br/>
&nbsp;&nbsp;(<span class="id" type="tactic">at</span> <span class="id" type="var">level</span> 70, <span class="id" type="var">no</span> <span class="id" type="var">associativity</span>) : <span class="id" type="var">nat_scope</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="isLowerAlpha"><span class="id" type="definition">isLowerAlpha</span></a> (<span class="id" type="var">c</span> : <a class="idref" href="http://coq.inria.fr/library/Coq.Strings.Ascii.html#ascii"><span class="id" type="inductive">ascii</span></a>) : <a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool"><span class="id" type="inductive">bool</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">n</span> := <a class="idref" href="http://coq.inria.fr/library/Coq.Strings.Ascii.html#nat_of_ascii"><span class="id" type="definition">nat_of_ascii</span></a> <a class="idref" href="ImpParser.html#c"><span class="id" type="variable">c</span></a> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#andb"><span class="id" type="definition">andb</span></a> (97 &lt;=? <a class="idref" href="ImpParser.html#n"><span class="id" type="variable">n</span></a>) (<a class="idref" href="ImpParser.html#n"><span class="id" type="variable">n</span></a> &lt;=? 122).<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="isAlpha"><span class="id" type="definition">isAlpha</span></a> (<span class="id" type="var">c</span> : <a class="idref" href="http://coq.inria.fr/library/Coq.Strings.Ascii.html#ascii"><span class="id" type="inductive">ascii</span></a>) : <a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool"><span class="id" type="inductive">bool</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">n</span> := <a class="idref" href="http://coq.inria.fr/library/Coq.Strings.Ascii.html#nat_of_ascii"><span class="id" type="definition">nat_of_ascii</span></a> <a class="idref" href="ImpParser.html#c"><span class="id" type="variable">c</span></a> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#orb"><span class="id" type="definition">orb</span></a> (<a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#andb"><span class="id" type="definition">andb</span></a> (65 &lt;=? <a class="idref" href="ImpParser.html#n"><span class="id" type="variable">n</span></a>) (<a class="idref" href="ImpParser.html#n"><span class="id" type="variable">n</span></a> &lt;=? 90))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#andb"><span class="id" type="definition">andb</span></a> (97 &lt;=? <a class="idref" href="ImpParser.html#n"><span class="id" type="variable">n</span></a>) (<a class="idref" href="ImpParser.html#n"><span class="id" type="variable">n</span></a> &lt;=? 122)).<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="isDigit"><span class="id" type="definition">isDigit</span></a> (<span class="id" type="var">c</span> : <a class="idref" href="http://coq.inria.fr/library/Coq.Strings.Ascii.html#ascii"><span class="id" type="inductive">ascii</span></a>) : <a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#bool"><span class="id" type="inductive">bool</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">n</span> := <a class="idref" href="http://coq.inria.fr/library/Coq.Strings.Ascii.html#nat_of_ascii"><span class="id" type="definition">nat_of_ascii</span></a> <a class="idref" href="ImpParser.html#c"><span class="id" type="variable">c</span></a> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#andb"><span class="id" type="definition">andb</span></a> (48 &lt;=? <a class="idref" href="ImpParser.html#n"><span class="id" type="variable">n</span></a>) (<a class="idref" href="ImpParser.html#n"><span class="id" type="variable">n</span></a> &lt;=? 57).<br/>

<br/>
<span class="id" type="keyword">Inductive</span> <a name="chartype"><span class="id" type="inductive">chartype</span></a> := <a name="white"><span class="id" type="constructor">white</span></a> | <a name="alpha"><span class="id" type="constructor">alpha</span></a> | <a name="digit"><span class="id" type="constructor">digit</span></a> | <a name="other"><span class="id" type="constructor">other</span></a>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="classifyChar"><span class="id" type="definition">classifyChar</span></a> (<span class="id" type="var">c</span> : <a class="idref" href="http://coq.inria.fr/library/Coq.Strings.Ascii.html#ascii"><span class="id" type="inductive">ascii</span></a>) : <a class="idref" href="ImpParser.html#chartype"><span class="id" type="inductive">chartype</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">if</span> <a class="idref" href="ImpParser.html#isWhite"><span class="id" type="definition">isWhite</span></a> <a class="idref" href="ImpParser.html#c"><span class="id" type="variable">c</span></a> <span class="id" type="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#white"><span class="id" type="constructor">white</span></a><br/>
&nbsp;&nbsp;<span class="id" type="keyword">else</span> <span class="id" type="keyword">if</span> <a class="idref" href="ImpParser.html#isAlpha"><span class="id" type="definition">isAlpha</span></a> <a class="idref" href="ImpParser.html#c"><span class="id" type="variable">c</span></a> <span class="id" type="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#alpha"><span class="id" type="constructor">alpha</span></a><br/>
&nbsp;&nbsp;<span class="id" type="keyword">else</span> <span class="id" type="keyword">if</span> <a class="idref" href="ImpParser.html#isDigit"><span class="id" type="definition">isDigit</span></a> <a class="idref" href="ImpParser.html#c"><span class="id" type="variable">c</span></a> <span class="id" type="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#digit"><span class="id" type="constructor">digit</span></a><br/>
&nbsp;&nbsp;<span class="id" type="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#other"><span class="id" type="constructor">other</span></a>.<br/>

<br/>
<span class="id" type="keyword">Fixpoint</span> <a name="list_of_string"><span class="id" type="definition">list_of_string</span></a> (<span class="id" type="var">s</span> : <a class="idref" href="http://coq.inria.fr/library/Coq.Strings.String.html#string"><span class="id" type="inductive">string</span></a>) : <a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list"><span class="id" type="inductive">list</span></a> <a class="idref" href="http://coq.inria.fr/library/Coq.Strings.Ascii.html#ascii"><span class="id" type="inductive">ascii</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <a class="idref" href="ImpParser.html#s"><span class="id" type="variable">s</span></a> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/library/Coq.Strings.String.html#EmptyString"><span class="id" type="constructor">EmptyString</span></a> ⇒ []<br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/library/Coq.Strings.String.html#String"><span class="id" type="constructor">String</span></a> <span class="id" type="var">c</span> <span class="id" type="var">s</span> ⇒ <span class="id" type="var">c</span> :: (<a class="idref" href="ImpParser.html#list_of_string"><span class="id" type="definition">list_of_string</span></a> <a class="idref" href="ImpParser.html#s"><span class="id" type="variable">s</span></a>)<br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Fixpoint</span> <a name="string_of_list"><span class="id" type="definition">string_of_list</span></a> (<span class="id" type="var">xs</span> : <a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list"><span class="id" type="inductive">list</span></a> <a class="idref" href="http://coq.inria.fr/library/Coq.Strings.Ascii.html#ascii"><span class="id" type="inductive">ascii</span></a>) : <a class="idref" href="http://coq.inria.fr/library/Coq.Strings.String.html#string"><span class="id" type="inductive">string</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_right"><span class="id" type="definition">fold_right</span></a> <a class="idref" href="http://coq.inria.fr/library/Coq.Strings.String.html#String"><span class="id" type="constructor">String</span></a> <a class="idref" href="http://coq.inria.fr/library/Coq.Strings.String.html#EmptyString"><span class="id" type="constructor">EmptyString</span></a> <a class="idref" href="ImpParser.html#xs"><span class="id" type="variable">xs</span></a>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="token"><span class="id" type="definition">token</span></a> := <a class="idref" href="http://coq.inria.fr/library/Coq.Strings.String.html#string"><span class="id" type="inductive">string</span></a>.<br/>

<br/>
<span class="id" type="keyword">Fixpoint</span> <a name="tokenize_helper"><span class="id" type="definition">tokenize_helper</span></a> (<span class="id" type="var">cls</span> : <a class="idref" href="ImpParser.html#chartype"><span class="id" type="inductive">chartype</span></a>) (<span class="id" type="var">acc</span> <span class="id" type="var">xs</span> : <a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list"><span class="id" type="inductive">list</span></a> <a class="idref" href="http://coq.inria.fr/library/Coq.Strings.Ascii.html#ascii"><span class="id" type="inductive">ascii</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list"><span class="id" type="inductive">list</span></a> (<a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list"><span class="id" type="inductive">list</span></a> <a class="idref" href="http://coq.inria.fr/library/Coq.Strings.Ascii.html#ascii"><span class="id" type="inductive">ascii</span></a>) :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">tk</span> := <span class="id" type="keyword">match</span> <a class="idref" href="ImpParser.html#acc"><span class="id" type="variable">acc</span></a> <span class="id" type="keyword">with</span> [] ⇒ [] | <span class="id" type="var">_</span>::_ ⇒ [<a class="idref" href="http://coq.inria.fr/library/Coq.Lists.List.html#rev"><span class="id" type="definition">rev</span></a> <a class="idref" href="ImpParser.html#acc"><span class="id" type="variable">acc</span></a>] <span class="id" type="keyword">end</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <a class="idref" href="ImpParser.html#xs"><span class="id" type="variable">xs</span></a> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;| [] ⇒ <a class="idref" href="ImpParser.html#tk"><span class="id" type="variable">tk</span></a><br/>
&nbsp;&nbsp;| (<span class="id" type="var">x</span>::<span class="id" type="var">xs'</span>) ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <a class="idref" href="ImpParser.html#cls"><span class="id" type="variable">cls</span></a>, <a class="idref" href="ImpParser.html#classifyChar"><span class="id" type="definition">classifyChar</span></a> <span class="id" type="var">x</span>, <span class="id" type="var">x</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span>, <span class="id" type="var">_</span>, "("      ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#tk"><span class="id" type="variable">tk</span></a> ++ ["("]::(<a class="idref" href="ImpParser.html#tokenize_helper"><span class="id" type="definition">tokenize_helper</span></a> <a class="idref" href="ImpParser.html#other"><span class="id" type="constructor">other</span></a> [] <span class="id" type="var">xs'</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span>, <span class="id" type="var">_</span>, ")"      ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#tk"><span class="id" type="variable">tk</span></a> ++ [")"]::(<a class="idref" href="ImpParser.html#tokenize_helper"><span class="id" type="definition">tokenize_helper</span></a> <a class="idref" href="ImpParser.html#other"><span class="id" type="constructor">other</span></a> [] <span class="id" type="var">xs'</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span>, <a class="idref" href="ImpParser.html#white"><span class="id" type="constructor">white</span></a>, <span class="id" type="var">_</span>    ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#tk"><span class="id" type="variable">tk</span></a> ++ (<a class="idref" href="ImpParser.html#tokenize_helper"><span class="id" type="definition">tokenize_helper</span></a> <a class="idref" href="ImpParser.html#white"><span class="id" type="constructor">white</span></a> [] <span class="id" type="var">xs'</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ImpParser.html#alpha"><span class="id" type="constructor">alpha</span></a>,<a class="idref" href="ImpParser.html#alpha"><span class="id" type="constructor">alpha</span></a>,<span class="id" type="var">x</span>  ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#tokenize_helper"><span class="id" type="definition">tokenize_helper</span></a> <a class="idref" href="ImpParser.html#alpha"><span class="id" type="constructor">alpha</span></a> (<span class="id" type="var">x</span>::<a class="idref" href="ImpParser.html#acc"><span class="id" type="variable">acc</span></a>) <span class="id" type="var">xs'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ImpParser.html#digit"><span class="id" type="constructor">digit</span></a>,<a class="idref" href="ImpParser.html#digit"><span class="id" type="constructor">digit</span></a>,<span class="id" type="var">x</span>  ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#tokenize_helper"><span class="id" type="definition">tokenize_helper</span></a> <a class="idref" href="ImpParser.html#digit"><span class="id" type="constructor">digit</span></a> (<span class="id" type="var">x</span>::<a class="idref" href="ImpParser.html#acc"><span class="id" type="variable">acc</span></a>) <span class="id" type="var">xs'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ImpParser.html#other"><span class="id" type="constructor">other</span></a>,<a class="idref" href="ImpParser.html#other"><span class="id" type="constructor">other</span></a>,<span class="id" type="var">x</span>  ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#tokenize_helper"><span class="id" type="definition">tokenize_helper</span></a> <a class="idref" href="ImpParser.html#other"><span class="id" type="constructor">other</span></a> (<span class="id" type="var">x</span>::<a class="idref" href="ImpParser.html#acc"><span class="id" type="variable">acc</span></a>) <span class="id" type="var">xs'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span>,<span class="id" type="var">tp</span>,<span class="id" type="var">x</span>         ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#tk"><span class="id" type="variable">tk</span></a> ++ (<a class="idref" href="ImpParser.html#tokenize_helper"><span class="id" type="definition">tokenize_helper</span></a> <span class="id" type="var">tp</span> [<span class="id" type="var">x</span>] <span class="id" type="var">xs'</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span> %<span class="id" type="var">char</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="tokenize"><span class="id" type="definition">tokenize</span></a> (<span class="id" type="var">s</span> : <a class="idref" href="http://coq.inria.fr/library/Coq.Strings.String.html#string"><span class="id" type="inductive">string</span></a>) : <a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list"><span class="id" type="inductive">list</span></a> <a class="idref" href="http://coq.inria.fr/library/Coq.Strings.String.html#string"><span class="id" type="inductive">string</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library/Coq.Lists.List.html#map"><span class="id" type="definition">map</span></a> <a class="idref" href="ImpParser.html#string_of_list"><span class="id" type="definition">string_of_list</span></a> (<a class="idref" href="ImpParser.html#tokenize_helper"><span class="id" type="definition">tokenize_helper</span></a> <a class="idref" href="ImpParser.html#white"><span class="id" type="constructor">white</span></a> [] (<a class="idref" href="ImpParser.html#list_of_string"><span class="id" type="definition">list_of_string</span></a> <a class="idref" href="ImpParser.html#s"><span class="id" type="variable">s</span></a>)).<br/>

<br/>
<span class="id" type="keyword">Example</span> <a name="tokenize_ex<sub>1</sub>"><span class="id" type="definition">tokenize_ex<sub>1</sub></span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#tokenize"><span class="id" type="definition">tokenize</span></a> "abc12==3  223*(3+(a+c))" %<span class="id" type="var">string</span><br/>
&nbsp;&nbsp;= ["abc"; "12"; "=="; "3"; "223";<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"*"; "("; "3"; "+"; "(";<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"a"; "+"; "c"; ")"; ")"]%<span class="id" type="var">string</span>.<br/>
<div class="togglescript" id="proofcontrol1" onclick="toggleDisplay('proof1');toggleDisplay('proofcontrol1')"><span class="show"></span></div>
<div class="proofscript" id="proof1" onclick="toggleDisplay('proof1');toggleDisplay('proofcontrol1')">
<span class="id" type="keyword">Proof</span>. <span class="id" type="tactic">reflexivity</span>. <span class="id" type="keyword">Qed</span>.<br/>
</div>

<br/>
</div>

<div class="doc">
<a name="lab347"></a><h2 class="section">Parsing</h2>

<div class="paragraph"> </div>

<a name="lab348"></a><h3 class="section">Options With Errors</h3>

<div class="paragraph"> </div>

 An <span class="inlinecode"><span class="id" type="var">option</span></span> type with error messages: 
</div>
<div class="code code-tight">

<br/>
<span class="id" type="keyword">Inductive</span> <a name="optionE"><span class="id" type="inductive">optionE</span></a> (<span class="id" type="var">X</span>:<span class="id" type="keyword">Type</span>) : <span class="id" type="keyword">Type</span> :=<br/>
&nbsp;&nbsp;| <a name="SomeE"><span class="id" type="constructor">SomeE</span></a> : <span class="id" type="var">X</span> <span style="font-family: arial;">&rarr;</span> <a class="idref" href="ImpParser.html#optionE"><span class="id" type="inductive">optionE</span></a> <span class="id" type="var">X</span><br/>
&nbsp;&nbsp;| <a name="NoneE"><span class="id" type="constructor">NoneE</span></a> : <a class="idref" href="http://coq.inria.fr/library/Coq.Strings.String.html#string"><span class="id" type="inductive">string</span></a> <span style="font-family: arial;">&rarr;</span> <a class="idref" href="ImpParser.html#optionE"><span class="id" type="inductive">optionE</span></a> <span class="id" type="var">X</span>.<br/>

<br/>
<span class="id" type="keyword">Implicit Arguments</span> <a class="idref" href="ImpParser.html#SomeE"><span class="id" type="constructor">SomeE</span></a> [[<span class="id" type="var">X</span>]].<br/>
<span class="id" type="keyword">Implicit Arguments</span> <a class="idref" href="ImpParser.html#NoneE"><span class="id" type="constructor">NoneE</span></a> [[<span class="id" type="var">X</span>]].<br/>

<br/>
</div>

<div class="doc">
Some syntactic sugar to make writing nested match-expressions on
    optionE more convenient. 
</div>
<div class="code code-tight">

<br/>
<span class="id" type="keyword">Notation</span> "'DO' ( x , y ) &lt;== e<sub>1</sub> ; e<sub>2</sub>"<br/>
&nbsp;&nbsp;&nbsp;:= (<span class="id" type="keyword">match</span> <span class="id" type="var">e<sub>1</sub></span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ImpParser.html#SomeE"><span class="id" type="constructor">SomeE</span></a> (<span class="id" type="var">x</span>,<span class="id" type="var">y</span>) ⇒ <span class="id" type="var">e<sub>2</sub></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ImpParser.html#NoneE"><span class="id" type="constructor">NoneE</span></a> <span class="id" type="var">err</span> ⇒ <a class="idref" href="ImpParser.html#NoneE"><span class="id" type="constructor">NoneE</span></a> <span class="id" type="var">err</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>)<br/>
&nbsp;&nbsp;&nbsp;(<span class="id" type="var">right</span> <span class="id" type="var">associativity</span>, <span class="id" type="tactic">at</span> <span class="id" type="var">level</span> 60).<br/>

<br/>
<span class="id" type="keyword">Notation</span> "'DO' ( x , y ) &lt;-- e<sub>1</sub> ; e<sub>2</sub> 'OR' e<sub>3</sub>"<br/>
&nbsp;&nbsp;&nbsp;:= (<span class="id" type="keyword">match</span> <span class="id" type="var">e<sub>1</sub></span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ImpParser.html#SomeE"><span class="id" type="constructor">SomeE</span></a> (<span class="id" type="var">x</span>,<span class="id" type="var">y</span>) ⇒ <span class="id" type="var">e<sub>2</sub></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="ImpParser.html#NoneE"><span class="id" type="constructor">NoneE</span></a> <span class="id" type="var">err</span> ⇒ <span class="id" type="var">e<sub>3</sub></span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>)<br/>
&nbsp;&nbsp;&nbsp;(<span class="id" type="var">right</span> <span class="id" type="var">associativity</span>, <span class="id" type="tactic">at</span> <span class="id" type="var">level</span> 60, <span class="id" type="var">e<sub>2</sub></span> <span class="id" type="tactic">at</span> <span class="id" type="var">next</span> <span class="id" type="var">level</span>).<br/>

<br/>
</div>

<div class="doc">
<a name="lab349"></a><h3 class="section">Symbol Table</h3>

<div class="paragraph"> </div>

 Build a mapping from <span class="inlinecode"><span class="id" type="var">tokens</span></span> to <span class="inlinecode"><span class="id" type="var">nats</span></span>.  A real parser would do
    this incrementally as it encountered new symbols, but passing
    around the symbol table inside the parsing functions is a bit
    inconvenient, so instead we do it as a first pass. 
</div>
<div class="code code-tight">

<br/>
<span class="id" type="keyword">Fixpoint</span> <a name="build_symtable"><span class="id" type="definition">build_symtable</span></a> (<span class="id" type="var">xs</span> : <a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list"><span class="id" type="inductive">list</span></a> <a class="idref" href="ImpParser.html#token"><span class="id" type="definition">token</span></a>) (<span class="id" type="var">n</span> : <a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat"><span class="id" type="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: (<a class="idref" href="ImpParser.html#token"><span class="id" type="definition">token</span></a> <span style="font-family: arial;">&rarr;</span> <a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat"><span class="id" type="inductive">nat</span></a>) :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <a class="idref" href="ImpParser.html#xs"><span class="id" type="variable">xs</span></a> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;| [] ⇒ (<span class="id" type="keyword">fun</span> <span class="id" type="var">s</span> ⇒ <a class="idref" href="ImpParser.html#n"><span class="id" type="variable">n</span></a>)<br/>
&nbsp;&nbsp;| <span class="id" type="var">x</span>::<span class="id" type="var">xs</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">if</span> (<a class="idref" href="http://coq.inria.fr/library/Coq.Lists.List.html#forallb"><span class="id" type="definition">forallb</span></a> <a class="idref" href="ImpParser.html#isLowerAlpha"><span class="id" type="definition">isLowerAlpha</span></a> (<a class="idref" href="ImpParser.html#list_of_string"><span class="id" type="definition">list_of_string</span></a> <span class="id" type="var">x</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">then</span> (<span class="id" type="keyword">fun</span> <span class="id" type="var">s</span> ⇒ <span class="id" type="keyword">if</span> <a class="idref" href="http://coq.inria.fr/library/Coq.Strings.String.html#string_dec"><span class="id" type="definition">string_dec</span></a> <a class="idref" href="ImpParser.html#s"><span class="id" type="variable">s</span></a> <span class="id" type="var">x</span> <span class="id" type="keyword">then</span> <a class="idref" href="ImpParser.html#n"><span class="id" type="variable">n</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">else</span> (<a class="idref" href="ImpParser.html#build_symtable"><span class="id" type="definition">build_symtable</span></a> <a class="idref" href="ImpParser.html#xs"><span class="id" type="variable">xs</span></a> (<a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <a class="idref" href="ImpParser.html#n"><span class="id" type="variable">n</span></a>) <a class="idref" href="ImpParser.html#s"><span class="id" type="variable">s</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">else</span> <a class="idref" href="ImpParser.html#build_symtable"><span class="id" type="definition">build_symtable</span></a> <a class="idref" href="ImpParser.html#xs"><span class="id" type="variable">xs</span></a> <a class="idref" href="ImpParser.html#n"><span class="id" type="variable">n</span></a><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab350"></a><h3 class="section">Generic Combinators for Building Parsers</h3>

</div>
<div class="code code-space">

<br/>
<span class="id" type="keyword">Open</span> <span class="id" type="keyword">Scope</span> <span class="id" type="var">string_scope</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="parser"><span class="id" type="definition">parser</span></a> (<span class="id" type="var">T</span> : <span class="id" type="keyword">Type</span>) :=<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list"><span class="id" type="inductive">list</span></a> <a class="idref" href="ImpParser.html#token"><span class="id" type="definition">token</span></a> <span style="font-family: arial;">&rarr;</span> <a class="idref" href="ImpParser.html#optionE"><span class="id" type="inductive">optionE</span></a> (<a class="idref" href="ImpParser.html#T"><span class="id" type="variable">T</span></a> * <a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list"><span class="id" type="inductive">list</span></a> <a class="idref" href="ImpParser.html#token"><span class="id" type="definition">token</span></a>).<br/>

<br/>
<span class="id" type="keyword">Fixpoint</span> <a name="many_helper"><span class="id" type="definition">many_helper</span></a> {<span class="id" type="var">T</span>} (<span class="id" type="var">p</span> : <a class="idref" href="ImpParser.html#parser"><span class="id" type="definition">parser</span></a> <a class="idref" href="ImpParser.html#T"><span class="id" type="variable">T</span></a>) <span class="id" type="var">acc</span> <span class="id" type="var">steps</span> <span class="id" type="var">xs</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <a class="idref" href="ImpParser.html#steps"><span class="id" type="variable">steps</span></a>, <a class="idref" href="ImpParser.html#p"><span class="id" type="variable">p</span></a> <a class="idref" href="ImpParser.html#xs"><span class="id" type="variable">xs</span></a> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;| 0, <span class="id" type="var">_</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#NoneE"><span class="id" type="constructor">NoneE</span></a> "Too many recursive calls"<br/>
&nbsp;&nbsp;| <span class="id" type="var">_</span>, <a class="idref" href="ImpParser.html#NoneE"><span class="id" type="constructor">NoneE</span></a> <span class="id" type="var">_</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#SomeE"><span class="id" type="constructor">SomeE</span></a> ((<a class="idref" href="http://coq.inria.fr/library/Coq.Lists.List.html#rev"><span class="id" type="definition">rev</span></a> <a class="idref" href="ImpParser.html#acc"><span class="id" type="variable">acc</span></a>), <a class="idref" href="ImpParser.html#xs"><span class="id" type="variable">xs</span></a>)<br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <span class="id" type="var">steps'</span>, <a class="idref" href="ImpParser.html#SomeE"><span class="id" type="constructor">SomeE</span></a> (<span class="id" type="var">t</span>, <span class="id" type="var">xs'</span>) ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#many_helper"><span class="id" type="definition">many_helper</span></a> <a class="idref" href="ImpParser.html#p"><span class="id" type="variable">p</span></a> (<span class="id" type="var">t</span>::<a class="idref" href="ImpParser.html#acc"><span class="id" type="variable">acc</span></a>) <span class="id" type="var">steps'</span> <span class="id" type="var">xs'</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
A (step-indexed) parser that expects zero or more <span class="inlinecode"><span class="id" type="var">p</span></span>s: 
</div>
<div class="code code-tight">

<br/>
<span class="id" type="keyword">Fixpoint</span> <a name="many"><span class="id" type="definition">many</span></a> {<span class="id" type="var">T</span>} (<span class="id" type="var">p</span> : <a class="idref" href="ImpParser.html#parser"><span class="id" type="definition">parser</span></a> <a class="idref" href="ImpParser.html#T"><span class="id" type="variable">T</span></a>) (<span class="id" type="var">steps</span> : <a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat"><span class="id" type="inductive">nat</span></a>) : <a class="idref" href="ImpParser.html#parser"><span class="id" type="definition">parser</span></a> (<a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list"><span class="id" type="inductive">list</span></a> <a class="idref" href="ImpParser.html#T"><span class="id" type="variable">T</span></a>) :=<br/>
&nbsp;&nbsp;<a class="idref" href="ImpParser.html#many_helper"><span class="id" type="definition">many_helper</span></a> <a class="idref" href="ImpParser.html#p"><span class="id" type="variable">p</span></a> [] <a class="idref" href="ImpParser.html#steps"><span class="id" type="variable">steps</span></a>.<br/>

<br/>
</div>

<div class="doc">
A parser that expects a given token, followed by <span class="inlinecode"><span class="id" type="var">p</span></span>: 
</div>
<div class="code code-tight">

<br/>
<span class="id" type="keyword">Definition</span> <a name="firstExpect"><span class="id" type="definition">firstExpect</span></a> {<span class="id" type="var">T</span>} (<span class="id" type="var">t</span> : <a class="idref" href="ImpParser.html#token"><span class="id" type="definition">token</span></a>) (<span class="id" type="var">p</span> : <a class="idref" href="ImpParser.html#parser"><span class="id" type="definition">parser</span></a> <a class="idref" href="ImpParser.html#T"><span class="id" type="variable">T</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="ImpParser.html#parser"><span class="id" type="definition">parser</span></a> <a class="idref" href="ImpParser.html#T"><span class="id" type="variable">T</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">fun</span> <span class="id" type="var">xs</span> ⇒ <span class="id" type="keyword">match</span> <a class="idref" href="ImpParser.html#xs"><span class="id" type="variable">xs</span></a> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">x</span>::<span class="id" type="var">xs'</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">if</span> <a class="idref" href="http://coq.inria.fr/library/Coq.Strings.String.html#string_dec"><span class="id" type="definition">string_dec</span></a> <span class="id" type="var">x</span> <a class="idref" href="ImpParser.html#t"><span class="id" type="variable">t</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">then</span> <a class="idref" href="ImpParser.html#p"><span class="id" type="variable">p</span></a> <span class="id" type="var">xs'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">else</span> <a class="idref" href="ImpParser.html#NoneE"><span class="id" type="constructor">NoneE</span></a> ("expected '" ++ <a class="idref" href="ImpParser.html#t"><span class="id" type="variable">t</span></a> ++ "'.")<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| [] ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#NoneE"><span class="id" type="constructor">NoneE</span></a> ("expected '" ++ <a class="idref" href="ImpParser.html#t"><span class="id" type="variable">t</span></a> ++ "'.")<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
A parser that expects a particular token: 
</div>
<div class="code code-tight">

<br/>
<span class="id" type="keyword">Definition</span> <a name="expect"><span class="id" type="definition">expect</span></a> (<span class="id" type="var">t</span> : <a class="idref" href="ImpParser.html#token"><span class="id" type="definition">token</span></a>) : <a class="idref" href="ImpParser.html#parser"><span class="id" type="definition">parser</span></a> <a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#unit"><span class="id" type="inductive">unit</span></a> :=<br/>
&nbsp;&nbsp;<a class="idref" href="ImpParser.html#firstExpect"><span class="id" type="definition">firstExpect</span></a> <a class="idref" href="ImpParser.html#t"><span class="id" type="variable">t</span></a> (<span class="id" type="keyword">fun</span> <span class="id" type="var">xs</span> ⇒ <a class="idref" href="ImpParser.html#SomeE"><span class="id" type="constructor">SomeE</span></a>(<a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#tt"><span class="id" type="constructor">tt</span></a>, <a class="idref" href="ImpParser.html#xs"><span class="id" type="variable">xs</span></a>)).<br/>

<br/>
</div>

<div class="doc">
<a name="lab351"></a><h3 class="section">A Recursive-Descent Parser for Imp</h3>

<div class="paragraph"> </div>

 Identifiers: 
</div>
<div class="code code-tight">

<br/>
<span class="id" type="keyword">Definition</span> <a name="parseIdentifier"><span class="id" type="definition">parseIdentifier</span></a> (<span class="id" type="var">symtable</span> :<a class="idref" href="http://coq.inria.fr/library/Coq.Strings.String.html#string"><span class="id" type="inductive">string</span></a><span style="font-family: arial;">&rarr;</span><a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat"><span class="id" type="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">xs</span> : <a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list"><span class="id" type="inductive">list</span></a> <a class="idref" href="ImpParser.html#token"><span class="id" type="definition">token</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="ImpParser.html#optionE"><span class="id" type="inductive">optionE</span></a> (<a class="idref" href="Maps.html#id"><span class="id" type="inductive">id</span></a> * <a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list"><span class="id" type="inductive">list</span></a> <a class="idref" href="ImpParser.html#token"><span class="id" type="definition">token</span></a>) :=<br/>
<span class="id" type="keyword">match</span> <a class="idref" href="ImpParser.html#xs"><span class="id" type="variable">xs</span></a> <span class="id" type="keyword">with</span><br/>
| [] ⇒ <a class="idref" href="ImpParser.html#NoneE"><span class="id" type="constructor">NoneE</span></a> "Expected identifier"<br/>
| <span class="id" type="var">x</span>::<span class="id" type="var">xs'</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">if</span> <a class="idref" href="http://coq.inria.fr/library/Coq.Lists.List.html#forallb"><span class="id" type="definition">forallb</span></a> <a class="idref" href="ImpParser.html#isLowerAlpha"><span class="id" type="definition">isLowerAlpha</span></a> (<a class="idref" href="ImpParser.html#list_of_string"><span class="id" type="definition">list_of_string</span></a> <span class="id" type="var">x</span>) <span class="id" type="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#SomeE"><span class="id" type="constructor">SomeE</span></a> (<a class="idref" href="Maps.html#Id"><span class="id" type="constructor">Id</span></a> (<a class="idref" href="ImpParser.html#symtable"><span class="id" type="variable">symtable</span></a> <span class="id" type="var">x</span>), <span class="id" type="var">xs'</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#NoneE"><span class="id" type="constructor">NoneE</span></a> ("Illegal identifier:'" ++ <span class="id" type="var">x</span> ++ "'")<br/>
<span class="id" type="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
Numbers: 
</div>
<div class="code code-tight">

<br/>
<span class="id" type="keyword">Definition</span> <a name="parseNumber"><span class="id" type="definition">parseNumber</span></a> (<span class="id" type="var">xs</span> : <a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list"><span class="id" type="inductive">list</span></a> <a class="idref" href="ImpParser.html#token"><span class="id" type="definition">token</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="ImpParser.html#optionE"><span class="id" type="inductive">optionE</span></a> (<a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat"><span class="id" type="inductive">nat</span></a> * <a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list"><span class="id" type="inductive">list</span></a> <a class="idref" href="ImpParser.html#token"><span class="id" type="definition">token</span></a>) :=<br/>
<span class="id" type="keyword">match</span> <a class="idref" href="ImpParser.html#xs"><span class="id" type="variable">xs</span></a> <span class="id" type="keyword">with</span><br/>
| [] ⇒ <a class="idref" href="ImpParser.html#NoneE"><span class="id" type="constructor">NoneE</span></a> "Expected number"<br/>
| <span class="id" type="var">x</span>::<span class="id" type="var">xs'</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">if</span> <a class="idref" href="http://coq.inria.fr/library/Coq.Lists.List.html#forallb"><span class="id" type="definition">forallb</span></a> <a class="idref" href="ImpParser.html#isDigit"><span class="id" type="definition">isDigit</span></a> (<a class="idref" href="ImpParser.html#list_of_string"><span class="id" type="definition">list_of_string</span></a> <span class="id" type="var">x</span>) <span class="id" type="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#SomeE"><span class="id" type="constructor">SomeE</span></a> (<a class="idref" href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_left"><span class="id" type="definition">fold_left</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">fun</span> <span class="id" type="var">n</span> <span class="id" type="var">d</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;10 * <a class="idref" href="ImpParser.html#n"><span class="id" type="variable">n</span></a> + (<a class="idref" href="http://coq.inria.fr/library/Coq.Strings.Ascii.html#nat_of_ascii"><span class="id" type="definition">nat_of_ascii</span></a> <a class="idref" href="ImpParser.html#d"><span class="id" type="variable">d</span></a> -<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library/Coq.Strings.Ascii.html#nat_of_ascii"><span class="id" type="definition">nat_of_ascii</span></a> "0"%<span class="id" type="var">char</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ImpParser.html#list_of_string"><span class="id" type="definition">list_of_string</span></a> <span class="id" type="var">x</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">xs'</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#NoneE"><span class="id" type="constructor">NoneE</span></a> "Expected number"<br/>
<span class="id" type="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
Parse arithmetic expressions 
</div>
<div class="code code-tight">

<br/>
<span class="id" type="keyword">Fixpoint</span> <a name="parsePrimaryExp"><span class="id" type="definition">parsePrimaryExp</span></a> (<span class="id" type="var">steps</span>:<a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat"><span class="id" type="inductive">nat</span></a>) <span class="id" type="var">symtable</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">xs</span> : <a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list"><span class="id" type="inductive">list</span></a> <a class="idref" href="ImpParser.html#token"><span class="id" type="definition">token</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <a class="idref" href="ImpParser.html#optionE"><span class="id" type="inductive">optionE</span></a> (<a class="idref" href="Imp.html#aexp"><span class="id" type="inductive">aexp</span></a> * <a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list"><span class="id" type="inductive">list</span></a> <a class="idref" href="ImpParser.html#token"><span class="id" type="definition">token</span></a>) :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <a class="idref" href="ImpParser.html#steps"><span class="id" type="variable">steps</span></a> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;| 0 ⇒ <a class="idref" href="ImpParser.html#NoneE"><span class="id" type="constructor">NoneE</span></a> "Too many recursive calls"<br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <span class="id" type="var">steps'</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#::'DO'_'('_x_','_x_')'_'<--'_x_';'_x_'OR'_x"><span class="id" type="notation">DO</span></a> (<span class="id" type="var">i</span>, <span class="id" type="var">rest</span>) &lt;-- <a class="idref" href="ImpParser.html#parseIdentifier"><span class="id" type="definition">parseIdentifier</span></a> <a class="idref" href="ImpParser.html#symtable"><span class="id" type="variable">symtable</span></a> <a class="idref" href="ImpParser.html#xs"><span class="id" type="variable">xs</span></a> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#SomeE"><span class="id" type="constructor">SomeE</span></a> (<a class="idref" href="Imp.html#AId"><span class="id" type="constructor">AId</span></a> <span class="id" type="var">i</span>, <span class="id" type="var">rest</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">OR</span> <a class="idref" href="ImpParser.html#::'DO'_'('_x_','_x_')'_'<--'_x_';'_x_'OR'_x"><span class="id" type="notation">DO</span></a> (<span class="id" type="var">n</span>, <span class="id" type="var">rest</span>) &lt;-- <a class="idref" href="ImpParser.html#parseNumber"><span class="id" type="definition">parseNumber</span></a> <a class="idref" href="ImpParser.html#xs"><span class="id" type="variable">xs</span></a> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#SomeE"><span class="id" type="constructor">SomeE</span></a> (<a class="idref" href="Imp.html#ANum"><span class="id" type="constructor">ANum</span></a> <span class="id" type="var">n</span>, <span class="id" type="var">rest</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">OR</span> (<a class="idref" href="ImpParser.html#::'DO'_'('_x_','_x_')'_'<=='_x_';'_x"><span class="id" type="notation">DO</span></a> (<span class="id" type="var">e</span>, <span class="id" type="var">rest</span>) &lt;== <a class="idref" href="ImpParser.html#firstExpect"><span class="id" type="definition">firstExpect</span></a> "("<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ImpParser.html#parseSumExp"><span class="id" type="definition">parseSumExp</span></a> <span class="id" type="var">steps'</span> <a class="idref" href="ImpParser.html#symtable"><span class="id" type="variable">symtable</span></a>) <a class="idref" href="ImpParser.html#xs"><span class="id" type="variable">xs</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#::'DO'_'('_x_','_x_')'_'<=='_x_';'_x"><span class="id" type="notation">DO</span></a> (<span class="id" type="var">u</span>, <span class="id" type="var">rest'</span>) &lt;== <a class="idref" href="ImpParser.html#expect"><span class="id" type="definition">expect</span></a> ")" <span class="id" type="var">rest</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#SomeE"><span class="id" type="constructor">SomeE</span></a>(<span class="id" type="var">e</span>,<span class="id" type="var">rest'</span>))<br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
<br/>
<span class="id" type="keyword">with</span> <a name="parseProductExp"><span class="id" type="definition">parseProductExp</span></a> (<span class="id" type="var">steps</span>:<a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat"><span class="id" type="inductive">nat</span></a>) <span class="id" type="var">symtable</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">xs</span> : <a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list"><span class="id" type="inductive">list</span></a> <a class="idref" href="ImpParser.html#token"><span class="id" type="definition">token</span></a>) :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <a class="idref" href="ImpParser.html#steps"><span class="id" type="variable">steps</span></a> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;| 0 ⇒ <a class="idref" href="ImpParser.html#NoneE"><span class="id" type="constructor">NoneE</span></a> "Too many recursive calls"<br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <span class="id" type="var">steps'</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#::'DO'_'('_x_','_x_')'_'<=='_x_';'_x"><span class="id" type="notation">DO</span></a> (<span class="id" type="var">e</span>, <span class="id" type="var">rest</span>) &lt;==<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#parsePrimaryExp"><span class="id" type="definition">parsePrimaryExp</span></a> <span class="id" type="var">steps'</span> <a class="idref" href="ImpParser.html#symtable"><span class="id" type="variable">symtable</span></a> <a class="idref" href="ImpParser.html#xs"><span class="id" type="variable">xs</span></a> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#::'DO'_'('_x_','_x_')'_'<=='_x_';'_x"><span class="id" type="notation">DO</span></a> (<span class="id" type="var">es</span>, <span class="id" type="var">rest'</span>) &lt;==<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#many"><span class="id" type="definition">many</span></a> (<a class="idref" href="ImpParser.html#firstExpect"><span class="id" type="definition">firstExpect</span></a> "*" (<a class="idref" href="ImpParser.html#parsePrimaryExp"><span class="id" type="definition">parsePrimaryExp</span></a> <span class="id" type="var">steps'</span> <a class="idref" href="ImpParser.html#symtable"><span class="id" type="variable">symtable</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">steps'</span> <span class="id" type="var">rest</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#SomeE"><span class="id" type="constructor">SomeE</span></a> (<a class="idref" href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_left"><span class="id" type="definition">fold_left</span></a> <a class="idref" href="Imp.html#AMult"><span class="id" type="constructor">AMult</span></a> <span class="id" type="var">es</span> <span class="id" type="var">e</span>, <span class="id" type="var">rest'</span>)<br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
<br/>
<span class="id" type="keyword">with</span> <a name="parseSumExp"><span class="id" type="definition">parseSumExp</span></a> (<span class="id" type="var">steps</span>:<a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat"><span class="id" type="inductive">nat</span></a>) <span class="id" type="var">symtable</span> (<span class="id" type="var">xs</span> : <a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list"><span class="id" type="inductive">list</span></a> <a class="idref" href="ImpParser.html#token"><span class="id" type="definition">token</span></a>)  :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <a class="idref" href="ImpParser.html#steps"><span class="id" type="variable">steps</span></a> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;| 0 ⇒ <a class="idref" href="ImpParser.html#NoneE"><span class="id" type="constructor">NoneE</span></a> "Too many recursive calls"<br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <span class="id" type="var">steps'</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#::'DO'_'('_x_','_x_')'_'<=='_x_';'_x"><span class="id" type="notation">DO</span></a> (<span class="id" type="var">e</span>, <span class="id" type="var">rest</span>) &lt;==<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#parseProductExp"><span class="id" type="definition">parseProductExp</span></a> <span class="id" type="var">steps'</span> <a class="idref" href="ImpParser.html#symtable"><span class="id" type="variable">symtable</span></a> <a class="idref" href="ImpParser.html#xs"><span class="id" type="variable">xs</span></a> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#::'DO'_'('_x_','_x_')'_'<=='_x_';'_x"><span class="id" type="notation">DO</span></a> (<span class="id" type="var">es</span>, <span class="id" type="var">rest'</span>) &lt;==<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#many"><span class="id" type="definition">many</span></a> (<span class="id" type="keyword">fun</span> <span class="id" type="var">xs</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#::'DO'_'('_x_','_x_')'_'<--'_x_';'_x_'OR'_x"><span class="id" type="notation">DO</span></a> (<span class="id" type="var">e</span>,<span class="id" type="var">rest'</span>) &lt;--<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#firstExpect"><span class="id" type="definition">firstExpect</span></a> "+"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ImpParser.html#parseProductExp"><span class="id" type="definition">parseProductExp</span></a> <span class="id" type="var">steps'</span> <a class="idref" href="ImpParser.html#symtable"><span class="id" type="variable">symtable</span></a>) <a class="idref" href="ImpParser.html#xs"><span class="id" type="variable">xs</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#SomeE"><span class="id" type="constructor">SomeE</span></a> ( (<a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true"><span class="id" type="constructor">true</span></a>, <span class="id" type="var">e</span>), <span class="id" type="var">rest'</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">OR</span> <a class="idref" href="ImpParser.html#::'DO'_'('_x_','_x_')'_'<=='_x_';'_x"><span class="id" type="notation">DO</span></a> (<span class="id" type="var">e</span>,<span class="id" type="var">rest'</span>) &lt;==<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#firstExpect"><span class="id" type="definition">firstExpect</span></a> "-"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ImpParser.html#parseProductExp"><span class="id" type="definition">parseProductExp</span></a> <span class="id" type="var">steps'</span> <a class="idref" href="ImpParser.html#symtable"><span class="id" type="variable">symtable</span></a>) <a class="idref" href="ImpParser.html#xs"><span class="id" type="variable">xs</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#SomeE"><span class="id" type="constructor">SomeE</span></a> ( (<a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false"><span class="id" type="constructor">false</span></a>, <span class="id" type="var">e</span>), <span class="id" type="var">rest'</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">steps'</span> <span class="id" type="var">rest</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#SomeE"><span class="id" type="constructor">SomeE</span></a> (<a class="idref" href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_left"><span class="id" type="definition">fold_left</span></a> (<span class="id" type="keyword">fun</span> <span class="id" type="var">e<sub>0</sub></span> <span class="id" type="var">term</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <a class="idref" href="ImpParser.html#term"><span class="id" type="variable">term</span></a> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#true"><span class="id" type="constructor">true</span></a>,  <span class="id" type="var">e</span>) ⇒ <a class="idref" href="Imp.html#APlus"><span class="id" type="constructor">APlus</span></a> <a class="idref" href="ImpParser.html#e<sub>0</sub>"><span class="id" type="variable">e<sub>0</sub></span></a> <span class="id" type="var">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| (<a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#false"><span class="id" type="constructor">false</span></a>, <span class="id" type="var">e</span>) ⇒ <a class="idref" href="Imp.html#AMinus"><span class="id" type="constructor">AMinus</span></a> <a class="idref" href="ImpParser.html#e<sub>0</sub>"><span class="id" type="variable">e<sub>0</sub></span></a> <span class="id" type="var">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">es</span> <span class="id" type="var">e</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">rest'</span>)<br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="parseAExp"><span class="id" type="definition">parseAExp</span></a> := <a class="idref" href="ImpParser.html#parseSumExp"><span class="id" type="definition">parseSumExp</span></a>.<br/>

<br/>
</div>

<div class="doc">
Parsing boolean expressions: 
</div>
<div class="code code-tight">

<br/>
<span class="id" type="keyword">Fixpoint</span> <a name="parseAtomicExp"><span class="id" type="definition">parseAtomicExp</span></a> (<span class="id" type="var">steps</span>:<a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat"><span class="id" type="inductive">nat</span></a>) (<span class="id" type="var">symtable</span> : <a class="idref" href="http://coq.inria.fr/library/Coq.Strings.String.html#string"><span class="id" type="inductive">string</span></a><span style="font-family: arial;">&rarr;</span><a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat"><span class="id" type="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">xs</span> : <a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list"><span class="id" type="inductive">list</span></a> <a class="idref" href="ImpParser.html#token"><span class="id" type="definition">token</span></a>)  :=<br/>
<span class="id" type="keyword">match</span> <a class="idref" href="ImpParser.html#steps"><span class="id" type="variable">steps</span></a> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;| 0 ⇒ <a class="idref" href="ImpParser.html#NoneE"><span class="id" type="constructor">NoneE</span></a> "Too many recursive calls"<br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <span class="id" type="var">steps'</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#::'DO'_'('_x_','_x_')'_'<--'_x_';'_x_'OR'_x"><span class="id" type="notation">DO</span></a>    (<span class="id" type="var">u</span>,<span class="id" type="var">rest</span>) &lt;-- <a class="idref" href="ImpParser.html#expect"><span class="id" type="definition">expect</span></a> "true" <a class="idref" href="ImpParser.html#xs"><span class="id" type="variable">xs</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#SomeE"><span class="id" type="constructor">SomeE</span></a> (<a class="idref" href="Imp.html#BTrue"><span class="id" type="constructor">BTrue</span></a>,<span class="id" type="var">rest</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">OR</span> <a class="idref" href="ImpParser.html#::'DO'_'('_x_','_x_')'_'<--'_x_';'_x_'OR'_x"><span class="id" type="notation">DO</span></a> (<span class="id" type="var">u</span>,<span class="id" type="var">rest</span>) &lt;-- <a class="idref" href="ImpParser.html#expect"><span class="id" type="definition">expect</span></a> "false" <a class="idref" href="ImpParser.html#xs"><span class="id" type="variable">xs</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#SomeE"><span class="id" type="constructor">SomeE</span></a> (<a class="idref" href="Imp.html#BFalse"><span class="id" type="constructor">BFalse</span></a>,<span class="id" type="var">rest</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">OR</span> <a class="idref" href="ImpParser.html#::'DO'_'('_x_','_x_')'_'<--'_x_';'_x_'OR'_x"><span class="id" type="notation">DO</span></a> (<span class="id" type="var">e</span>,<span class="id" type="var">rest</span>) &lt;-- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#firstExpect"><span class="id" type="definition">firstExpect</span></a> "not" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ImpParser.html#parseAtomicExp"><span class="id" type="definition">parseAtomicExp</span></a> <span class="id" type="var">steps'</span> <a class="idref" href="ImpParser.html#symtable"><span class="id" type="variable">symtable</span></a>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#xs"><span class="id" type="variable">xs</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#SomeE"><span class="id" type="constructor">SomeE</span></a> (<a class="idref" href="Imp.html#BNot"><span class="id" type="constructor">BNot</span></a> <span class="id" type="var">e</span>, <span class="id" type="var">rest</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">OR</span> <a class="idref" href="ImpParser.html#::'DO'_'('_x_','_x_')'_'<--'_x_';'_x_'OR'_x"><span class="id" type="notation">DO</span></a> (<span class="id" type="var">e</span>,<span class="id" type="var">rest</span>) &lt;-- <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#firstExpect"><span class="id" type="definition">firstExpect</span></a> "(" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ImpParser.html#parseConjunctionExp"><span class="id" type="definition">parseConjunctionExp</span></a> <span class="id" type="var">steps'</span> <a class="idref" href="ImpParser.html#symtable"><span class="id" type="variable">symtable</span></a>) <a class="idref" href="ImpParser.html#xs"><span class="id" type="variable">xs</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ImpParser.html#::'DO'_'('_x_','_x_')'_'<=='_x_';'_x"><span class="id" type="notation">DO</span></a> (<span class="id" type="var">u</span>,<span class="id" type="var">rest'</span>) &lt;== <a class="idref" href="ImpParser.html#expect"><span class="id" type="definition">expect</span></a> ")" <span class="id" type="var">rest</span>; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#SomeE"><span class="id" type="constructor">SomeE</span></a> (<span class="id" type="var">e</span>, <span class="id" type="var">rest'</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">OR</span> <a class="idref" href="ImpParser.html#::'DO'_'('_x_','_x_')'_'<=='_x_';'_x"><span class="id" type="notation">DO</span></a> (<span class="id" type="var">e</span>, <span class="id" type="var">rest</span>) &lt;== <a class="idref" href="ImpParser.html#parseProductExp"><span class="id" type="definition">parseProductExp</span></a> <span class="id" type="var">steps'</span> <a class="idref" href="ImpParser.html#symtable"><span class="id" type="variable">symtable</span></a> <a class="idref" href="ImpParser.html#xs"><span class="id" type="variable">xs</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ImpParser.html#::'DO'_'('_x_','_x_')'_'<--'_x_';'_x_'OR'_x"><span class="id" type="notation">DO</span></a> (<span class="id" type="var">e'</span>, <span class="id" type="var">rest'</span>) &lt;--<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#firstExpect"><span class="id" type="definition">firstExpect</span></a> "==" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ImpParser.html#parseAExp"><span class="id" type="definition">parseAExp</span></a> <span class="id" type="var">steps'</span> <a class="idref" href="ImpParser.html#symtable"><span class="id" type="variable">symtable</span></a>) <span class="id" type="var">rest</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#SomeE"><span class="id" type="constructor">SomeE</span></a> (<a class="idref" href="Imp.html#BEq"><span class="id" type="constructor">BEq</span></a> <span class="id" type="var">e</span> <span class="id" type="var">e'</span>, <span class="id" type="var">rest'</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">OR</span> <a class="idref" href="ImpParser.html#::'DO'_'('_x_','_x_')'_'<--'_x_';'_x_'OR'_x"><span class="id" type="notation">DO</span></a> (<span class="id" type="var">e'</span>, <span class="id" type="var">rest'</span>) &lt;--<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#firstExpect"><span class="id" type="definition">firstExpect</span></a> "≤" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ImpParser.html#parseAExp"><span class="id" type="definition">parseAExp</span></a> <span class="id" type="var">steps'</span> <a class="idref" href="ImpParser.html#symtable"><span class="id" type="variable">symtable</span></a>) <span class="id" type="var">rest</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#SomeE"><span class="id" type="constructor">SomeE</span></a> (<a class="idref" href="Imp.html#BLe"><span class="id" type="constructor">BLe</span></a> <span class="id" type="var">e</span> <span class="id" type="var">e'</span>, <span class="id" type="var">rest'</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">OR</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#NoneE"><span class="id" type="constructor">NoneE</span></a> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Expected '==' or '≤' after arithmetic expression")<br/>
<span class="id" type="keyword">end</span><br/>
<br/>
<span class="id" type="keyword">with</span> <a name="parseConjunctionExp"><span class="id" type="definition">parseConjunctionExp</span></a> (<span class="id" type="var">steps</span>:<a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat"><span class="id" type="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">symtable</span> : <a class="idref" href="http://coq.inria.fr/library/Coq.Strings.String.html#string"><span class="id" type="inductive">string</span></a><span style="font-family: arial;">&rarr;</span><a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat"><span class="id" type="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">xs</span> : <a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list"><span class="id" type="inductive">list</span></a> <a class="idref" href="ImpParser.html#token"><span class="id" type="definition">token</span></a>) :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <a class="idref" href="ImpParser.html#steps"><span class="id" type="variable">steps</span></a> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;| 0 ⇒ <a class="idref" href="ImpParser.html#NoneE"><span class="id" type="constructor">NoneE</span></a> "Too many recursive calls"<br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <span class="id" type="var">steps'</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#::'DO'_'('_x_','_x_')'_'<=='_x_';'_x"><span class="id" type="notation">DO</span></a> (<span class="id" type="var">e</span>, <span class="id" type="var">rest</span>) &lt;==<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#parseAtomicExp"><span class="id" type="definition">parseAtomicExp</span></a> <span class="id" type="var">steps'</span> <a class="idref" href="ImpParser.html#symtable"><span class="id" type="variable">symtable</span></a> <a class="idref" href="ImpParser.html#xs"><span class="id" type="variable">xs</span></a> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#::'DO'_'('_x_','_x_')'_'<=='_x_';'_x"><span class="id" type="notation">DO</span></a> (<span class="id" type="var">es</span>, <span class="id" type="var">rest'</span>) &lt;==<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#many"><span class="id" type="definition">many</span></a> (<a class="idref" href="ImpParser.html#firstExpect"><span class="id" type="definition">firstExpect</span></a> "&amp;&amp;"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ImpParser.html#parseAtomicExp"><span class="id" type="definition">parseAtomicExp</span></a> <span class="id" type="var">steps'</span> <a class="idref" href="ImpParser.html#symtable"><span class="id" type="variable">symtable</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">steps'</span> <span class="id" type="var">rest</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#SomeE"><span class="id" type="constructor">SomeE</span></a> (<a class="idref" href="http://coq.inria.fr/library/Coq.Lists.List.html#fold_left"><span class="id" type="definition">fold_left</span></a> <a class="idref" href="Imp.html#BAnd"><span class="id" type="constructor">BAnd</span></a> <span class="id" type="var">es</span> <span class="id" type="var">e</span>, <span class="id" type="var">rest'</span>)<br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="parseBExp"><span class="id" type="definition">parseBExp</span></a> := <a class="idref" href="ImpParser.html#parseConjunctionExp"><span class="id" type="definition">parseConjunctionExp</span></a>.<br/>

<br/>
<span class="id" type="keyword">Check</span> <a class="idref" href="ImpParser.html#parseConjunctionExp"><span class="id" type="definition">parseConjunctionExp</span></a>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="testParsing"><span class="id" type="definition">testParsing</span></a> {<span class="id" type="var">X</span> : <span class="id" type="keyword">Type</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">p</span> : <a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat"><span class="id" type="inductive">nat</span></a> <span style="font-family: arial;">&rarr;</span> (<a class="idref" href="http://coq.inria.fr/library/Coq.Strings.String.html#string"><span class="id" type="inductive">string</span></a> <span style="font-family: arial;">&rarr;</span> <a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat"><span class="id" type="inductive">nat</span></a>) <span style="font-family: arial;">&rarr;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list"><span class="id" type="inductive">list</span></a> <a class="idref" href="ImpParser.html#token"><span class="id" type="definition">token</span></a> <span style="font-family: arial;">&rarr;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#optionE"><span class="id" type="inductive">optionE</span></a> (<a class="idref" href="ImpParser.html#X"><span class="id" type="variable">X</span></a> * <a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list"><span class="id" type="inductive">list</span></a> <a class="idref" href="ImpParser.html#token"><span class="id" type="definition">token</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">s</span> : <a class="idref" href="http://coq.inria.fr/library/Coq.Strings.String.html#string"><span class="id" type="inductive">string</span></a>) :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">t</span> := <a class="idref" href="ImpParser.html#tokenize"><span class="id" type="definition">tokenize</span></a> <a class="idref" href="ImpParser.html#s"><span class="id" type="variable">s</span></a> <span class="id" type="keyword">in</span> <br/>
&nbsp;&nbsp;<a class="idref" href="ImpParser.html#p"><span class="id" type="variable">p</span></a> 100 (<a class="idref" href="ImpParser.html#build_symtable"><span class="id" type="definition">build_symtable</span></a> <a class="idref" href="ImpParser.html#t"><span class="id" type="variable">t</span></a> 0) <a class="idref" href="ImpParser.html#t"><span class="id" type="variable">t</span></a>.<br/>

<br/>
<span class="comment">(*<br/>
Eval&nbsp;compute&nbsp;in&nbsp;<br/>
&nbsp;&nbsp;testParsing&nbsp;parseProductExp&nbsp;"x*y*(x*x)*x".<br/>
<br/>
Eval&nbsp;compute&nbsp;in&nbsp;<br/>
&nbsp;&nbsp;testParsing&nbsp;parseConjunctionExp&nbsp;"not((x==x||x*x&lt;=(x*x)*x)&amp;&amp;x==x".&nbsp;<br/>
*)</span><br/>

<br/>
</div>

<div class="doc">
Parsing commands: 
</div>
<div class="code code-tight">

<br/>
<span class="id" type="keyword">Fixpoint</span> <a name="parseSimpleCommand"><span class="id" type="definition">parseSimpleCommand</span></a> (<span class="id" type="var">steps</span>:<a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat"><span class="id" type="inductive">nat</span></a>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">symtable</span>:<a class="idref" href="http://coq.inria.fr/library/Coq.Strings.String.html#string"><span class="id" type="inductive">string</span></a><span style="font-family: arial;">&rarr;</span><a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat"><span class="id" type="inductive">nat</span></a>) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">xs</span> : <a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list"><span class="id" type="inductive">list</span></a> <a class="idref" href="ImpParser.html#token"><span class="id" type="definition">token</span></a>) :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <a class="idref" href="ImpParser.html#steps"><span class="id" type="variable">steps</span></a> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;| 0 ⇒ <a class="idref" href="ImpParser.html#NoneE"><span class="id" type="constructor">NoneE</span></a> "Too many recursive calls"<br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <span class="id" type="var">steps'</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#::'DO'_'('_x_','_x_')'_'<--'_x_';'_x_'OR'_x"><span class="id" type="notation">DO</span></a> (<span class="id" type="var">u</span>, <span class="id" type="var">rest</span>) &lt;-- <a class="idref" href="ImpParser.html#expect"><span class="id" type="definition">expect</span></a> "SKIP" <a class="idref" href="ImpParser.html#xs"><span class="id" type="variable">xs</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#SomeE"><span class="id" type="constructor">SomeE</span></a> (<a class="idref" href="Imp.html#::'SKIP'"><span class="id" type="notation">SKIP</span></a>, <span class="id" type="var">rest</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">OR</span> <a class="idref" href="ImpParser.html#::'DO'_'('_x_','_x_')'_'<--'_x_';'_x_'OR'_x"><span class="id" type="notation">DO</span></a> (<span class="id" type="var">e</span>,<span class="id" type="var">rest</span>) &lt;--<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#firstExpect"><span class="id" type="definition">firstExpect</span></a> "IF" (<a class="idref" href="ImpParser.html#parseBExp"><span class="id" type="definition">parseBExp</span></a> <span class="id" type="var">steps'</span> <a class="idref" href="ImpParser.html#symtable"><span class="id" type="variable">symtable</span></a>) <a class="idref" href="ImpParser.html#xs"><span class="id" type="variable">xs</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#::'DO'_'('_x_','_x_')'_'<=='_x_';'_x"><span class="id" type="notation">DO</span></a> (<span class="id" type="var">c</span>,<span class="id" type="var">rest'</span>)  &lt;==<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#firstExpect"><span class="id" type="definition">firstExpect</span></a> "THEN" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ImpParser.html#parseSequencedCommand"><span class="id" type="definition">parseSequencedCommand</span></a> <span class="id" type="var">steps'</span> <a class="idref" href="ImpParser.html#symtable"><span class="id" type="variable">symtable</span></a>) <span class="id" type="var">rest</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#::'DO'_'('_x_','_x_')'_'<=='_x_';'_x"><span class="id" type="notation">DO</span></a> (<span class="id" type="var">c'</span>,<span class="id" type="var">rest''</span>) &lt;==<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#firstExpect"><span class="id" type="definition">firstExpect</span></a> "ELSE" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ImpParser.html#parseSequencedCommand"><span class="id" type="definition">parseSequencedCommand</span></a> <span class="id" type="var">steps'</span> <a class="idref" href="ImpParser.html#symtable"><span class="id" type="variable">symtable</span></a>) <span class="id" type="var">rest'</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#::'DO'_'('_x_','_x_')'_'<=='_x_';'_x"><span class="id" type="notation">DO</span></a> (<span class="id" type="var">u</span>,<span class="id" type="var">rest'''</span>) &lt;==<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#expect"><span class="id" type="definition">expect</span></a> "END" <span class="id" type="var">rest''</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#SomeE"><span class="id" type="constructor">SomeE</span></a>(<a class="idref" href="Imp.html#::'IFB'_x_'THEN'_x_'ELSE'_x_'FI'"><span class="id" type="notation">IFB</span></a> <span class="id" type="var">e</span> <span class="id" type="var">THEN</span> <span class="id" type="var">c</span> <span class="id" type="var">ELSE</span> <span class="id" type="var">c'</span> <span class="id" type="var">FI</span>, <span class="id" type="var">rest'''</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">OR</span> <a class="idref" href="ImpParser.html#::'DO'_'('_x_','_x_')'_'<--'_x_';'_x_'OR'_x"><span class="id" type="notation">DO</span></a> (<span class="id" type="var">e</span>,<span class="id" type="var">rest</span>) &lt;--<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#firstExpect"><span class="id" type="definition">firstExpect</span></a> "WHILE" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ImpParser.html#parseBExp"><span class="id" type="definition">parseBExp</span></a> <span class="id" type="var">steps'</span> <a class="idref" href="ImpParser.html#symtable"><span class="id" type="variable">symtable</span></a>) <a class="idref" href="ImpParser.html#xs"><span class="id" type="variable">xs</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#::'DO'_'('_x_','_x_')'_'<=='_x_';'_x"><span class="id" type="notation">DO</span></a> (<span class="id" type="var">c</span>,<span class="id" type="var">rest'</span>) &lt;==<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#firstExpect"><span class="id" type="definition">firstExpect</span></a> "DO" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ImpParser.html#parseSequencedCommand"><span class="id" type="definition">parseSequencedCommand</span></a> <span class="id" type="var">steps'</span> <a class="idref" href="ImpParser.html#symtable"><span class="id" type="variable">symtable</span></a>) <span class="id" type="var">rest</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#::'DO'_'('_x_','_x_')'_'<=='_x_';'_x"><span class="id" type="notation">DO</span></a> (<span class="id" type="var">u</span>,<span class="id" type="var">rest''</span>) &lt;==<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#expect"><span class="id" type="definition">expect</span></a> "END" <span class="id" type="var">rest'</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#SomeE"><span class="id" type="constructor">SomeE</span></a>(<a class="idref" href="Imp.html#::'WHILE'_x_'DO'_x_'END'"><span class="id" type="notation">WHILE</span></a> <span class="id" type="var">e</span> <span class="id" type="var">DO</span> <span class="id" type="var">c</span> <span class="id" type="var">END</span>, <span class="id" type="var">rest''</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">OR</span> <a class="idref" href="ImpParser.html#::'DO'_'('_x_','_x_')'_'<=='_x_';'_x"><span class="id" type="notation">DO</span></a> (<span class="id" type="var">i</span>, <span class="id" type="var">rest</span>) &lt;==<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#parseIdentifier"><span class="id" type="definition">parseIdentifier</span></a> <a class="idref" href="ImpParser.html#symtable"><span class="id" type="variable">symtable</span></a> <a class="idref" href="ImpParser.html#xs"><span class="id" type="variable">xs</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#::'DO'_'('_x_','_x_')'_'<=='_x_';'_x"><span class="id" type="notation">DO</span></a> (<span class="id" type="var">e</span>, <span class="id" type="var">rest'</span>) &lt;==<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#firstExpect"><span class="id" type="definition">firstExpect</span></a> ":=" (<a class="idref" href="ImpParser.html#parseAExp"><span class="id" type="definition">parseAExp</span></a> <span class="id" type="var">steps'</span> <a class="idref" href="ImpParser.html#symtable"><span class="id" type="variable">symtable</span></a>) <span class="id" type="var">rest</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#SomeE"><span class="id" type="constructor">SomeE</span></a>(<span class="id" type="var">i</span> ::= <span class="id" type="var">e</span>, <span class="id" type="var">rest'</span>)<br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
<br/>
<span class="id" type="keyword">with</span> <a name="parseSequencedCommand"><span class="id" type="definition">parseSequencedCommand</span></a> (<span class="id" type="var">steps</span>:<a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat"><span class="id" type="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">symtable</span>:<a class="idref" href="http://coq.inria.fr/library/Coq.Strings.String.html#string"><span class="id" type="inductive">string</span></a><span style="font-family: arial;">&rarr;</span><a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#nat"><span class="id" type="inductive">nat</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">xs</span> : <a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list"><span class="id" type="inductive">list</span></a> <a class="idref" href="ImpParser.html#token"><span class="id" type="definition">token</span></a>) :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <a class="idref" href="ImpParser.html#steps"><span class="id" type="variable">steps</span></a> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;| 0 ⇒ <a class="idref" href="ImpParser.html#NoneE"><span class="id" type="constructor">NoneE</span></a> "Too many recursive calls"<br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <span class="id" type="var">steps'</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#::'DO'_'('_x_','_x_')'_'<=='_x_';'_x"><span class="id" type="notation">DO</span></a> (<span class="id" type="var">c</span>, <span class="id" type="var">rest</span>) &lt;==<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#parseSimpleCommand"><span class="id" type="definition">parseSimpleCommand</span></a> <span class="id" type="var">steps'</span> <a class="idref" href="ImpParser.html#symtable"><span class="id" type="variable">symtable</span></a> <a class="idref" href="ImpParser.html#xs"><span class="id" type="variable">xs</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#::'DO'_'('_x_','_x_')'_'<--'_x_';'_x_'OR'_x"><span class="id" type="notation">DO</span></a> (<span class="id" type="var">c'</span>, <span class="id" type="var">rest'</span>) &lt;--<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#firstExpect"><span class="id" type="definition">firstExpect</span></a> ";" <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ImpParser.html#parseSequencedCommand"><span class="id" type="definition">parseSequencedCommand</span></a> <span class="id" type="var">steps'</span> <a class="idref" href="ImpParser.html#symtable"><span class="id" type="variable">symtable</span></a>) <span class="id" type="var">rest</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#SomeE"><span class="id" type="constructor">SomeE</span></a>(<span class="id" type="var">c</span> ;; <span class="id" type="var">c'</span>, <span class="id" type="var">rest'</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">OR</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="ImpParser.html#SomeE"><span class="id" type="constructor">SomeE</span></a>(<span class="id" type="var">c</span>, <span class="id" type="var">rest</span>)<br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="bignumber"><span class="id" type="definition">bignumber</span></a> := 1000.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="parse"><span class="id" type="definition">parse</span></a> (<span class="id" type="var">str</span> : <a class="idref" href="http://coq.inria.fr/library/Coq.Strings.String.html#string"><span class="id" type="inductive">string</span></a>) : <a class="idref" href="ImpParser.html#optionE"><span class="id" type="inductive">optionE</span></a> (<a class="idref" href="Imp.html#com"><span class="id" type="inductive">com</span></a> * <a class="idref" href="http://coq.inria.fr/library/Coq.Init.Datatypes.html#list"><span class="id" type="inductive">list</span></a> <a class="idref" href="ImpParser.html#token"><span class="id" type="definition">token</span></a>) :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">tokens</span> := <a class="idref" href="ImpParser.html#tokenize"><span class="id" type="definition">tokenize</span></a> <a class="idref" href="ImpParser.html#str"><span class="id" type="variable">str</span></a> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<a class="idref" href="ImpParser.html#parseSequencedCommand"><span class="id" type="definition">parseSequencedCommand</span></a> <a class="idref" href="ImpParser.html#bignumber"><span class="id" type="definition">bignumber</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="ImpParser.html#build_symtable"><span class="id" type="definition">build_symtable</span></a> <a class="idref" href="ImpParser.html#tokens"><span class="id" type="variable">tokens</span></a> 0) <a class="idref" href="ImpParser.html#tokens"><span class="id" type="variable">tokens</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab352"></a><h1 class="section">Examples</h1>

</div>
<div class="code code-space">

<br/>
<span class="comment">(*<br/>
Compute&nbsp;parse&nbsp;"<br/>
&nbsp;&nbsp;IF&nbsp;x&nbsp;==&nbsp;y&nbsp;+&nbsp;1&nbsp;+&nbsp;2&nbsp;-&nbsp;y&nbsp;*&nbsp;6&nbsp;+&nbsp;3&nbsp;THEN<br/>
&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;x&nbsp;*&nbsp;1;;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;0<br/>
&nbsp;&nbsp;ELSE<br/>
&nbsp;&nbsp;&nbsp;&nbsp;SKIP<br/>
&nbsp;&nbsp;END&nbsp;&nbsp;".<br/>
====&gt;<br/>
&nbsp;&nbsp;SomeE<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(IFB&nbsp;BEq&nbsp;(AId&nbsp;(Id&nbsp;0))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(APlus<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(AMinus&nbsp;(APlus&nbsp;(APlus&nbsp;(AId&nbsp;(Id&nbsp;1))&nbsp;(ANum&nbsp;1))&nbsp;(ANum&nbsp;2))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(AMult&nbsp;(AId&nbsp;(Id&nbsp;1))&nbsp;(ANum&nbsp;6)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(ANum&nbsp;3))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;THEN&nbsp;Id&nbsp;0&nbsp;::=&nbsp;AMult&nbsp;(AId&nbsp;(Id&nbsp;0))&nbsp;(ANum&nbsp;1);;&nbsp;Id&nbsp;1&nbsp;::=&nbsp;ANum&nbsp;0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE&nbsp;SKIP&nbsp;FI,&nbsp;<span class="inlinecode"></span>)<br/>
*)</span><br/>

<br/>
<span class="comment">(*<br/>
Compute&nbsp;parse&nbsp;"<br/>
&nbsp;&nbsp;SKIP;;<br/>
&nbsp;&nbsp;z:=x*y*(x*x);;<br/>
&nbsp;&nbsp;WHILE&nbsp;x==x&nbsp;DO<br/>
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;z&nbsp;&lt;=&nbsp;z*z&nbsp;&amp;&amp;&nbsp;not&nbsp;x&nbsp;==&nbsp;2&nbsp;THEN<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;z;;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;z<br/>
&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SKIP<br/>
&nbsp;&nbsp;&nbsp;&nbsp;END;;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;SKIP<br/>
&nbsp;&nbsp;END;;<br/>
&nbsp;&nbsp;x:=z&nbsp;&nbsp;".<br/>
====&gt;<br/>
&nbsp;&nbsp;SomeE<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(SKIP;;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Id&nbsp;0&nbsp;::=&nbsp;AMult&nbsp;(AMult&nbsp;(AId&nbsp;(Id&nbsp;1))&nbsp;(AId&nbsp;(Id&nbsp;2)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(AMult&nbsp;(AId&nbsp;(Id&nbsp;1))&nbsp;(AId&nbsp;(Id&nbsp;1)));;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHILE&nbsp;BEq&nbsp;(AId&nbsp;(Id&nbsp;1))&nbsp;(AId&nbsp;(Id&nbsp;1))&nbsp;DO<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IFB&nbsp;BAnd&nbsp;(BLe&nbsp;(AId&nbsp;(Id&nbsp;0))&nbsp;(AMult&nbsp;(AId&nbsp;(Id&nbsp;0))&nbsp;(AId&nbsp;(Id&nbsp;0))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(BNot&nbsp;(BEq&nbsp;(AId&nbsp;(Id&nbsp;1))&nbsp;(ANum&nbsp;2)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;THEN&nbsp;Id&nbsp;1&nbsp;::=&nbsp;AId&nbsp;(Id&nbsp;0);;&nbsp;Id&nbsp;2&nbsp;::=&nbsp;AId&nbsp;(Id&nbsp;0)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE&nbsp;SKIP&nbsp;FI;;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SKIP<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END;;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Id&nbsp;1&nbsp;::=&nbsp;AId&nbsp;(Id&nbsp;0),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="inlinecode"></span>)<br/>
*)</span><br/>

<br/>
<span class="comment">(*<br/>
Compute&nbsp;parse&nbsp;"<br/>
&nbsp;&nbsp;SKIP;;<br/>
&nbsp;&nbsp;z:=x*y*(x*x);;<br/>
&nbsp;&nbsp;WHILE&nbsp;x==x&nbsp;DO<br/>
&nbsp;&nbsp;&nbsp;&nbsp;IF&nbsp;z&nbsp;&lt;=&nbsp;z*z&nbsp;&amp;&amp;&nbsp;not&nbsp;x&nbsp;==&nbsp;2&nbsp;THEN<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;x&nbsp;:=&nbsp;z;;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;y&nbsp;:=&nbsp;z<br/>
&nbsp;&nbsp;&nbsp;&nbsp;ELSE<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SKIP<br/>
&nbsp;&nbsp;&nbsp;&nbsp;END;;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;SKIP<br/>
&nbsp;&nbsp;END;;<br/>
&nbsp;&nbsp;x:=z&nbsp;&nbsp;".<br/>
=====&gt;<br/>
&nbsp;&nbsp;SomeE<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(SKIP;;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Id&nbsp;0&nbsp;::=&nbsp;AMult&nbsp;(AMult&nbsp;(AId&nbsp;(Id&nbsp;1))&nbsp;(AId&nbsp;(Id&nbsp;2)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(AMult&nbsp;(AId&nbsp;(Id&nbsp;1))&nbsp;(AId&nbsp;(Id&nbsp;1)));;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;WHILE&nbsp;BEq&nbsp;(AId&nbsp;(Id&nbsp;1))&nbsp;(AId&nbsp;(Id&nbsp;1))&nbsp;DO<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IFB&nbsp;BAnd&nbsp;(BLe&nbsp;(AId&nbsp;(Id&nbsp;0))&nbsp;(AMult&nbsp;(AId&nbsp;(Id&nbsp;0))&nbsp;(AId&nbsp;(Id&nbsp;0))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(BNot&nbsp;(BEq&nbsp;(AId&nbsp;(Id&nbsp;1))&nbsp;(ANum&nbsp;2)))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;THEN&nbsp;Id&nbsp;1&nbsp;::=&nbsp;AId&nbsp;(Id&nbsp;0);;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Id&nbsp;2&nbsp;::=&nbsp;AId&nbsp;(Id&nbsp;0)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ELSE&nbsp;SKIP<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;FI;;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;SKIP<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;END;;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Id&nbsp;1&nbsp;::=&nbsp;AId&nbsp;(Id&nbsp;0),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="inlinecode"></span>).<br/>
*)</span><br/>

<br/>
</div>

<div class="doc">
 
</div>
<div class="code code-tight">
</div>
</div>

<div id="footer">
<hr/><a href="coqindex.html">Index</a></div>

</div>

</body>
</html>